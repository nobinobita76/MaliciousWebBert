<!DOCTYPE html>
<html>
 <head> 
  <meta charset="utf-8" /> 
  <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0" /> 
  <title id="title">Spring实现AOP常用的四种方式</title> 
  <meta name="keywords" content="Spring实现AOP常用的四种方式" /> 
  <meta name="description" content="





先了解AOP的相关术语:
1.通知(Advice):
通知定义了切面是什么以及何时使用。描述了切面要完成的工作和何时需要执行这个工作。
2.连接点(Joinpoint):
程序能够应用通知的一个“时机”，这些“时机”就是连接点，例如方法被调用时、异常被抛出时等等。
3.切入点(Pointcut)
通知定义了切面要发生的“故事”和时间，那么切入点就定义了“故事”发" /> 
  <link rel="canonical" href="http://m.fx114.net/qa-105-155873.aspx" /> 
  <link type="text/css" rel="stylesheet" href="css/2014/m/style131017.css" /> 
  <link href="css/2014/m/media_queries.css" rel="stylesheet" type="text/css" /> 
  <!--[if lt IE 9]>
	<script src="/js/2014/m/html5shiv.js"></script>
<![endif]--> 
  <!--[if lt IE 9]> 
	<script src="/js/2014/m/css3-mediaqueries.js"></script>  
<![endif]--> 
  <script type="text/javascript" src="js/2014/m/jquery-1.5.min.js"></script> 
  <script type="text/javascript" src="js/2014/m/list.js"></script> 
  <script type="text/javascript" src="js/2014/m/click_more.js"></script> 
  <script type="text/javascript" src="js/2014/m/top.js"></script> 
  <script type="text/javascript">
<!--
    function getOs() {
        var OsObject = "";
        //IE
        if (navigator.userAgent.indexOf("MSIE") > 0) { return -1; }
        //火狐
        if (isFirefox = navigator.userAgent.indexOf("Firefox") > 0) { return -1; }
        //360极速
        if (isSafari = navigator.userAgent.indexOf("Safari") > 0) { return -2; }
        //谷歌
        if (isCamino = navigator.userAgent.indexOf("Camino") > 0) { return -2; }
        //火狐
        if (isMozilla = navigator.userAgent.indexOf("Gecko/") > 0) { return -1; }
    } 
--> 
</script> 
 </head> 
 <body> 
  <script type="text/javascript">
    /*创建于 2017/3/21 mb*/
    var cpro_id = "u2931063";
</script> 
  <script type="text/javascript" src="http://cpro.baidustatic.com/cpro/ui/cm.js"></script> 
  <header> 
   <div class="loc_logo_nav"> 
    <div class="loc_logo_navbtn"> 
     <div class="loc_logo"> 
      <div class="loc">
       <a href="#" onclick="javascript:history.go(getOs());"><img src="images/2014/m/back_icon_50x50.jpg" alt="分享查询网" /></a>
      </div> 
      <div class="logo"> 
       <h1><span id="spanNav"><a href="List-2-105-1.aspx" title="VCL组件使用和开发">VCL组件使用和开发</a></span></h1> 
      </div> 
     </div> 
     <div class="navbtn" id="navbtn"></div> 
    </div> 
    <nav> 
     <ul> 
      <li><a href="List-2-102-1.aspx" title="Windows SDK/API">Windows SDK/API</a></li> 
      <li><a href="List-2-103-1.aspx" title="茶馆">茶馆</a></li> 
      <li><a href="List-2-104-1.aspx" title="ActiveX/COM/DCOM">ActiveX/COM/DCOM</a></li> 
      <li><a href="List-2-105-1.aspx" title="VCL组件使用和开发">VCL组件使用和开发</a></li> 
      <li><a href="List-2-106-1.aspx" title="网络及通讯开发">网络及通讯开发</a></li> 
      <li><a href="List-2-107-1.aspx" title="数据库及相关技术">数据库及相关技术</a></li> 
      <li><a href="List-2-108-1.aspx" title="基础类">基础类</a></li> 
      <div class="clear"></div> 
     </ul> 
    </nav> 
   </div> 
   <div class="clear"> 
   </div> 
  </header> 
  <article> 
   <h2 id="h2Value">Spring实现AOP常用的四种方式</h2> 
   <div class="time_source"> 
    <span id="spanAddTime">发布时间：2015-11-20 23:26:11</span>
    <br />来源：分享查询网 
   </div> 
   <div class="content"> 
    <p id="pContent"></p>
    <div id="article_content" class="article_content">
     <p> </p>
     <table style="color:rgb(68,68,68); font-size:16px; line-height:24px"> 
      <tbody> 
       <tr> 
        <td width="670px"><br /> <br /> 先了解AOP的相关术语:&nbsp;<br /> 1.通知(Advice):&nbsp;<br /> 通知定义了切面是什么以及何时使用。描述了切面要完成的工作和何时需要执行这个工作。&nbsp;<br /> 2.连接点(Joinpoint):&nbsp;<br /> 程序能够应用通知的一个“时机”，这些“时机”就是连接点，例如方法被调用时、异常被抛出时等等。&nbsp;<br /> 3.切入点(Pointcut)&nbsp;<br /> 通知定义了切面要发生的“故事”和时间，那么切入点就定义了“故事”发生的地点，例如某个类或方法的名称，Spring中允许我们方便的用正则表达式来指定&nbsp;<br /> 4.切面(Aspect)&nbsp;<br /> 通知和切入点共同组成了切面：时间、地点和要发生的“故事”&nbsp;<br /> 5.引入(Introduction)&nbsp;<br /> 引入允许我们向现有的类添加新的方法和属性(Spring提供了一个方法注入的功能）&nbsp;<br /> 6.目标(Target)&nbsp;<br /> 即被通知的对象，如果没有AOP,那么它的逻辑将要交叉别的事务逻辑，有了AOP之后它可以只关注自己要做的事（AOP让他做爱做的事）&nbsp;<br /> 7.代理(proxy)&nbsp;<br /> 应用通知的对象，详细内容参见设计模式里面的代理模式&nbsp;<br /> 8.织入(Weaving)&nbsp;<br /> 把切面应用到目标对象来创建新的代理对象的过程，织入一般发生在如下几个时机:&nbsp;<br /> (1)编译时：当一个类文件被编译时进行织入，这需要特殊的编译器才可以做的到，例如AspectJ的织入编译器&nbsp;<br /> (2)类加载时：使用特殊的ClassLoader在目标类被加载到程序之前增强类的字节代码&nbsp;<br /> (3)运行时：切面在运行的某个时刻被织入,SpringAOP就是以这种方式织入切面的，原理应该是使用了JDK的动态代理技术&nbsp;<br /> <br /> <br /> <span style="font-size:18px"><span style="color:red"><span style="font-size:18px; line-height:27px">Spring提供了4种实现AOP的方式</span></span></span>：&nbsp;<br /> 1.经典的基于代理的AOP&nbsp;<br /> 2.@AspectJ注解驱动的切面&nbsp;<br /> 3.纯POJO切面&nbsp;<br /> 4.注入式AspectJ切面&nbsp;<br /> <br /> 首先看经典的基于代理的AOP:&nbsp;<br /> <br /> Spring支持五种类型的通知：&nbsp;<br /> Before(前)&nbsp; org.apringframework.aop.MethodBeforeAdvice&nbsp;<br /> After-returning(返回后) org.springframework.aop.AfterReturningAdvice&nbsp;<br /> After-throwing(抛出后) org.springframework.aop.ThrowsAdvice&nbsp;<br /> Arround(周围) org.aopaliance.intercept.MethodInterceptor&nbsp;<br /> Introduction(引入) org.springframework.aop.IntroductionInterceptor&nbsp;<br /> <br /> 值的说明的是周围通知，他是由AOP Alliance中的接口定义的而非Spring,周围通知相当于前通知、返回后通知、抛出后通知的结合（传说中的完全体？好吧，我看日和看多&nbsp;<br /> <br /> 了）还有引入通知怎么玩我还没搞清楚，等心无杂念的时候玩玩&nbsp;<br /> <br /> 这东西怎么玩？这么几个步骤：&nbsp;<br /> 1.创建通知：实现这几个接口，把其中的方法实现了&nbsp;<br /> 2.定义切点和通知者：在Spring配制文件中配置这些信息&nbsp;<br /> 3.使用ProxyFactoryBean来生成代理&nbsp;<br /> <br /> 具体做法。。。大晚上的就举个睡觉的例子吧:&nbsp;<br /> <br /> 首先写一个接口叫Sleepable,这是一个牛X的接口,所有具有睡觉能力的东西都可以实现该接口（不光生物，包括关机选项里面的休眠）&nbsp;<br /> <br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Java代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-j"> 
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">package</span></strong></span>&nbsp;test.spring.aop.bean &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">interface</span></strong></span>&nbsp;Sleepable{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;sleep();&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">}&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> <br /> 然后写一个Human类，他实现了这个接口&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Java代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-j"> 
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">package</span></strong></span>&nbsp;test.spring.aop.bean &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;Human&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">implements</span></strong></span>&nbsp;Sleepable{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;<span class="comment"><span style="color:#008200; line-height:24px">/*这人莫非跟寡人差不多？&nbsp;</span></span>&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="comment"><span style="color:#008200; line-height:24px">&nbsp;&nbsp;&nbsp;&nbsp;*除了睡觉睡的比较好之外其余的什么也不会做？*/</span></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;sleep(){ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;睡觉了！梦中自有颜如玉！&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">}&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> <br /> 好了，这是主角，不过睡觉前后要做些辅助工作的，最基本的是脱穿衣服，失眠的人还要吃安眠药什么的,但是这些动作与纯粹的睡觉这一“业务逻辑”是不相干的，如果把&nbsp;<br /> <br /> 这些代码全部加入到sleep方法中，是不是有违单一职责呢？，这时候我们就需要AOP了。&nbsp;<br /> <br /> 编写一个SleepHelper类，它里面包含了睡觉的辅助工作,用AOP术语来说它就应该是通知了，我们需要实现上面的接口&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Java代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-j"> 
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">package</span></strong></span>&nbsp;test.spring.aop.bean; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;java.lang.reflect.Method; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.springframework.aop.AfterReturningAdvice; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.springframework.aop.MethodBeforeAdvice; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">class</span></strong></span>&nbsp;SleepHelper&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">implements</span></strong></span>&nbsp;MethodBeforeAdvice,AfterReturningAdvice{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;before(Method&nbsp;mtd,&nbsp;Object[]&nbsp;arg1,&nbsp;Object&nbsp;arg2) &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">throws</span></strong></span>&nbsp;Throwable&nbsp;{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;通常情况下睡觉之前要脱衣服！&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;afterReturning(Object&nbsp;arg0,&nbsp;Method&nbsp;arg1,&nbsp;Object[]&nbsp;arg2, &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;arg3)&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">throws</span></strong></span>&nbsp;Throwable&nbsp;{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;起床后要先穿衣服！&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">}&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> 然后在spring配置文件中进行配置:&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Xml代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-xml"> 
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">bean</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">id</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;sleepHelper&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">class</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;test.spring.aop.bean.SleepHelper&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;/</span><span class="tag-name">bean</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> OK!现在创建通知的工作就完成了.&nbsp;<br /> <br /> 第二步是进行配置，这是很令人蛋疼的操作，尤其是这么热的天，Spring又把东西的名字起的见鬼的长！它为啥不能像usr这种风格呢？&nbsp;<br /> <br /> 首先要做的是配置一个切点,据说切点的表示方式在Spring中有好几种，但是常用的只有两种：1.使用正则表达式 2.使用AspectJ表达式 AspectJ我不是很熟悉(我也是熟悉&nbsp;<br /> <br /> 党 or 精通党？),我还是习惯用正则表达式&nbsp;<br /> <br /> Spring使用org.springframework.aop.support.JdkRegexpMethodPointcut来定义正则表达式切点&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Xml代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-xml"> 
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">bean</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">id</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;spleepPointcut&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">class</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;org.springframework.aop.support.JdkRegexpMethodPointcut&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">property</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">name</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;pattern&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">value</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;.*sleep&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;/</span><span class="tag-name">bean</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> pattern属性指定了正则表达式，它匹配所有的sleep方法&nbsp;<br /> <br /> 切点仅仅是定义了故事发生的地点，还有故事发生的时间以及最重要的故事的内容,就是通知了，我们需要把通知跟切点结合起来，我们要使用的通知者是:&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Java代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-j"> 
           <li style="padding:0px; margin:0px; line-height:23px">org.springframework.aop.support.DefaultPointcutAdvisor &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&lt;bean&nbsp;id=<span class="string"><span style="color:#0000ff; line-height:24px">&quot;sleepHelperAdvisor&quot;</span></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">class</span></strong></span>=<span class="string"><span style="color:#0000ff; line-height:24px">&quot;org.springframework.aop.support.DefaultPointcutAdvisor&quot;</span></span>&gt; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=<span class="string"><span style="color:#0000ff; line-height:24px">&quot;advice&quot;</span></span>&nbsp;ref=<span class="string"><span style="color:#0000ff; line-height:24px">&quot;sleepHelper&quot;</span></span>/&gt; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=<span class="string"><span style="color:#0000ff; line-height:24px">&quot;pointcut&quot;</span></span>&nbsp;ref=<span class="string"><span style="color:#0000ff; line-height:24px">&quot;sleepPointcut&quot;</span></span>/&gt; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&lt;/bean&gt;&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> 切入点和通知都配置完成，接下来该调用ProxyFactoryBean产生代理对象了&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Xml代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-xml"> 
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">bean</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">id</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;humanProxy&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">class</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;org.springframework.aop.framework.ProxyFactoryBean&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">property</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">name</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;target&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">ref</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;human&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">property</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">name</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;interceptorNames&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">value</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;sleepHelperAdvisor&quot;</span></span>&nbsp;<span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">property</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">name</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;proxyInterfaces&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">value</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;test.spring.aop.bean.Sleepable&quot;</span></span>&nbsp;<span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;/</span><span class="tag-name">bean</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> ProxyFactoryBean是一个代理，我们可以把它转换为proxyInterfaces中指定的实现该interface的代理对象:&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Java代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-j"> 
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.springframework.aop.framework.ProxyFactoryBean; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.springframework.context.ApplicationContext; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.springframework.context.support.ClassPathXmlApplicationContext; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;test.spring.aop.bean.Sleepable; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">class</span></strong></span>&nbsp;Test&nbsp;{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">static</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;main(String[]&nbsp;args){ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ApplicationContext&nbsp;appCtx&nbsp;=&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">new</span></strong></span>&nbsp;ClassPathXmlApplicationContext(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;applicationContext.xml&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleepable&nbsp;sleeper&nbsp;=&nbsp;(Sleepable)appCtx.getBean(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;humanProxy&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleeper.sleep(); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">}&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> 程序运行产生结果：&nbsp;<br /> 通常情况下睡觉之前要脱衣服！&nbsp;<br /> 睡觉啦~梦中自有颜如玉!&nbsp;<br /> 起床后要先穿衣服！&nbsp;<br /> <br /> OK!这是我们想要的结果，但是上面这个过程貌似有点复杂，尤其是配置切点跟通知,Spring提供了一种自动代理的功能，能让切点跟通知自动进行匹配，修改配置文件如下:&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Xml代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-xml"> 
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">bean</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">id</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;sleepHelper&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">class</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;test.spring.aop.bean.SleepHelper&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;/</span><span class="tag-name">bean</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">bean</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">id</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;sleepAdvisor&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">class</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;org.springframework.aop.support.RegexpMethodPointcutAdvisor&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">property</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">name</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;advice&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">ref</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;sleepHelper&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">property</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">name</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;pattern&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">value</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;.*sleep&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;/</span><span class="tag-name">bean</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">bean</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">id</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;human&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">class</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;test.spring.aop.bean.Human&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;/</span><span class="tag-name">bean</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">bean</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">class</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> 执行程序：&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Java代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-j"> 
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">class</span></strong></span>&nbsp;Test&nbsp;{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">static</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;main(String[]&nbsp;args){ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ApplicationContext&nbsp;appCtx&nbsp;=&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">new</span></strong></span>&nbsp;ClassPathXmlApplicationContext(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;applicationContext.xml&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleepable&nbsp;sleeper&nbsp;=&nbsp;(Sleepable)appCtx.getBean(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;human&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleeper.sleep(); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">}&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> 成功输出结果跟前面一样!&nbsp;<br /> 只要我们声明了org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator(我勒个去的，名太长了)就能为方法匹配的bean自动创建代理！&nbsp;<br /> <br /> 但是这样还是要有很多工作要做,有更简单的方式吗?有！&nbsp;<br /> <br /> 一种方式是使用AspectJ提供的注解:&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Java代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-j"> 
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">package</span></strong></span>&nbsp;test.mine.spring.bean; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.aspectj.lang.annotation.AfterReturning; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.aspectj.lang.annotation.Aspect; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.aspectj.lang.annotation.Before; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">import</span></strong></span>&nbsp;org.aspectj.lang.annotation.Pointcut; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="annotation"><span style="color:#646464; line-height:24px">@Aspect</span></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">class</span></strong></span>&nbsp;SleepHelper&nbsp;{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;SleepHelper(){ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="annotation"><span style="color:#646464; line-height:24px">@Pointcut</span></span>(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;execution(*&nbsp;*.sleep())&quot;</span></span>) &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;sleeppoint(){} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="annotation"><span style="color:#646464; line-height:24px">@Before</span></span>(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;sleeppoint()&quot;</span></span>) &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;beforeSleep(){ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;睡觉前要脱衣服!&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="annotation"><span style="color:#646464; line-height:24px">@AfterReturning</span></span>(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;sleeppoint()&quot;</span></span>) &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;afterSleep(){ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;睡醒了要穿衣服！&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">}&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="799eedd139380a091c1a0d9ee3fd9fcad191deda9fe4dc9fd9fe91d6ff9cf1fe90e4db">[email&nbsp;protected]</a><script data-cfhash="f9e31" type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>,注意不要把它漏了，否则Spring创建代理的时候会找不到它,@Pointcut注解指定了切点，@<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="85c7e0e3eaf7e0601709c5c4e3f1e0f7d7e0f1f0f7ebecebe2630902602b1f613f036d3a156d2409631233621f016c051f621a20">[email&nbsp;protected]</a><script data-cfhash="f9e31" type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>，注&nbsp;<br /> <br /> 意的是要在注解中传入切点的名称&nbsp;<br /> <br /> 然后我们在Spring配置文件上下点功夫,首先是增加AOP的XML命名空间和声明相关schema&nbsp;<br /> 命名空间:&nbsp;<br /> xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;&nbsp;<br /> schema声明:&nbsp;<br /> http://www.springframework.org/schema/aop&nbsp;<br /> http://www.springframework.org/schema/aop/spring-aop-2.0.xsd&nbsp;<br /> <br /> 然后加上这个标签:&nbsp;<br /> &lt;aop:aspectj-autoproxy/&gt; <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="f91f65701d437f1146601d4153aa898b90979e1c4948117a441c5d66117e531c73511f70521f7676115b52b9b88a899c9a8d1f597e1f4a511e637d1c717e10645b1d">[email&nbsp;protected]</a><script data-cfhash="f9e31" type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>1717&nbsp;<br /> <br /> 最后是运行，很简单方便了：&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Java代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-j"> 
           <li style="padding:0px; margin:0px; line-height:23px"><span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">class</span></strong></span>&nbsp;Test&nbsp;{ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">public</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">static</span></strong></span>&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">void</span></strong></span>&nbsp;main(String[]&nbsp;args){ &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ApplicationContext&nbsp;appCtx&nbsp;=&nbsp;<span class="keyword"><strong><span style="color:#7f0055; line-height:24px">new</span></strong></span>&nbsp;ClassPathXmlApplicationContext(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;applicationContext.xml&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleepable&nbsp;human&nbsp;=&nbsp;(Sleepable)appCtx.getBean(<span class="string"><span style="color:#0000ff; line-height:24px">&quot;human&quot;</span></span>); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;human.sleep(); &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">}&nbsp;&nbsp;</li>
          </ol> 
         </div> <br /> 下面我们来看最后一种常用的实现AOP的方式:使用Spring来定义纯粹的POJO切面&nbsp;<br /> <br /> 前面我们用到了&lt;aop:aspectj-autoproxy/&gt;标签,Spring在aop的命名空间里面还提供了其他的配置元素:&nbsp;<br /> &lt;aop:advisor&gt; 定义一个AOP通知者&nbsp;<br /> &lt;aop:after&gt; 后通知&nbsp;<br /> &lt;aop:after-returning&gt; 返回后通知&nbsp;<br /> &lt;aop:after-throwing&gt; 抛出后通知&nbsp;<br /> &lt;aop:around&gt; 周围通知&nbsp;<br /> &lt;aop:aspect&gt;定义一个切面&nbsp;<br /> &lt;aop:before&gt;前通知&nbsp;<br /> &lt;aop:config&gt;顶级配置元素，类似于&lt;beans&gt;这种东西&nbsp;<br /> &lt;aop:pointcut&gt;定义一个切点&nbsp;<br /> <br /> 我们用AOP标签来实现睡觉这个过程:&nbsp;<br /> 代码不变，只是修改配置文件,加入AOP配置即可:&nbsp;<br /> 
         <div class="dp-highlighter"> 
          <div class="bar"> 
           <div class="tools">
            Xml代码&nbsp;
            <a rel="nofollow" target="_blank" title="复制代码" href="http://spring.group.javaeye.com/group/blog/837497#" style="color:rgb(61,107,167); text-decoration:none"><img alt="复制代码" src="http://image19.360doc.com/DownloadImg/2010/12/1511/7673790_1.gif" style="border:0px" /></a>
           </div> 
          </div> 
          <ol class="dp-xml"> 
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">aop:config</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">aop:aspect</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">ref</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;sleepHelper&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">aop:before</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">method</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;beforeSleep&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">pointcut</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;execution(*&nbsp;*.sleep(..))&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;</span><span class="tag-name">aop:after</span></span></strong>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">method</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;afterSleep&quot;</span></span>&nbsp;<span class="attribute"><span style="color:#ff0000; line-height:24px">pointcut</span></span>=<span class="attribute-value"><span style="color:#0000ff; line-height:24px">&quot;execution(*&nbsp;*.sleep(..))&quot;</span></span><span class="tag"><strong><span style="color:#006699; line-height:24px">/&gt;</span></strong></span>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;/</span><span class="tag-name">aop:aspect</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
           <li style="padding:0px; margin:0px; line-height:23px"><strong><span style="color:#006699; line-height:24px"><span class="tag">&lt;/</span><span class="tag-name">aop:config</span><span class="tag">&gt;</span></span></strong>&nbsp;&nbsp;</li>
          </ol> 
         </div> </td> 
       </tr> 
      </tbody> 
     </table> 转自：
     <a rel="nofollow" target="_blank" href="http://www.360doc.com/content/13/0815/13/13516769_307309564.shtml">http://www.360doc.com/content/13/0815/13/13516769_307309564.shtml</a>
     <p></p> 
    </div>
    <p></p> 
   </div> 
  </article> 
  <div id="top"> 
   <img src="images/2014/m/top_icon_31x11.png" id="goTopBtn" title="返回顶部" alt="返回顶部" /> 
  </div> 
  <div class="computer"> 
   <a href="http://www.fx114.net/qa-105-155873.aspx" target="_blank">查看电脑版</a> 
  </div> 
  <footer> 
   <p class="fontArial">Copyright &copy;2017 <a href="http://m.fx114.net/" title="分享查询网">分享查询网</a> All rights reserved.</p> 
  </footer> 
  <div style="display:none;"> 
   <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?b41e21aaf49ad2eda6b7f39b8d1dd98e";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
</script> 
  </div>  
 </body>
</html>