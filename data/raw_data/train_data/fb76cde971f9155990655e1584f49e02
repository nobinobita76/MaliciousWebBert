<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8;">
<meta name="keywords" content="新疆农村信用社 个人网上银行">
<meta name="description" content="新疆农村信用社个人网上银行致力于为客户提供远程无忧、随时随地的零距离金融服务.">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta http-equiv="Cache-Control" content="no-cache">
<title>新疆农村信用社</title>
<link rel="shortcut icon" href="/perbank/resource/newUI/images/customize/xjrccb/logo.ico">




<script language="javascript" src="/perbank/resource/js/jquery/jquery-1.8.2.min.js?version=1,0,0,2" type="text/javascript"></script>
<script type="text/javascript">
var jQuery2 = jQuery.noConflict(true);
</script>
<script src="/perbank/resource/js/layer/layer.js?version=1,0,0,0"></script><link rel="stylesheet" href="https://www.xjrccb.com.cn/perbank/resource/js/layer/skin/layer.css" id="layui_layer_skinlayercss" style="">

<script language="javascript" src="/perbank/resource/js/jquery/jquery-1.5.2.js?version=1,0,0,2" type="text/javascript"></script>
<script language="javascript" src="/perbank/resource/js/ajax.js?version=1,0,0,2" type="text/javascript"></script>
<script language="javascript" src="/perbank/resource/js/commValidate.js?version=1,0,0,5" type="text/javascript"></script>
<script language="javascript" src="/perbank/resource/js/commUtil.js?version=1,0,0,2" type="text/javascript"></script>
<script language="javascript" src="/perbank/resource/js/cookie.js?version=1,0,0,2"></script>

<script language="javascript" src="/perbank/resource/js/money.js?version=1,0,0,2" type="text/javascript"></script>
<script language="javascript" src="/perbank/resource/js/public.js?version=1,0,0,2" type="text/javascript"></script>
<script language="javascript" src="/perbank/resource/js/ui.js?version=1,0,0,2" type="text/javascript"></script>
<script type="text/javascript">
  /* window.alert=function(msg)
{
     layer.alert(msg, {
         icon: 2,
         skin: 'layui-layer-lan'
           ,closeBtn: 1 
          , title: '温馨提示',//该皮肤由layer.seaning.com友情扩展。关于皮肤的扩展规则，去这里查阅
     });
}; 

 function newconfirm(msg,fn,s)
 {
 	layer.confirm(msg, 
 			{icon: 3,skin: 'layui-layer-lan',shade : false, title:'温馨提示'}, function(index){
 		  layer.close(index);
 		  fn(s);//do something
 		}, function(index) {
 		  layer.close(index);
 	      return false;
 		});
 }; */



// var rr;
// window.confirm=function(msg){
// 		layer.confirm(msg, {
// 			btn : [ '提交', '取消' ], //按钮
// 			shade : false,
// 			skin: 'layer-ext-moon',
// 			title:'温馨提示'
// 		//不显示遮罩
// 		}, function(index) {
// 			rr = true;
// 			layer.close(index);
// 		}, function(index) {
// 			rr = false;
// 			layer.close(index);
// 		});
// 		return rr;
// 	};

function initSafeTool(){
	var safeToolArray = "";
	var strs= new Array(); //定义一数组 
	strs=safeToolArray.split(","); //字符分割 	
	var cell = document.getElementById("safeToolChoise");
	var html="";
	for (i=0;i<strs.length ;i++ ) 
	{ 
		var safeToolList= new Array();
		safeToolList = strs[i].split(":");
		var objectId = "safeTool" + i;
		if(i == 0){//默认选中第一个
			html +=   '<input type="radio" name="safeTool"  value="'+safeToolList[0]+'" id="'+objectId+'" checked="true" onclick="javascript:queryLimitBalance()"/>' + safeToolList[1];
		}else{
			html +=   '<input type="radio" name="safeTool"  value="'+safeToolList[0]+'" id="'+objectId+'" onclick="javascript:queryLimitBalance()"/>' + safeToolList[1];
		}
	} 
	cell.innerHTML=html;
}
</script>
<script type="text/javascript" src="/perbank/resource/newUI/js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="/perbank/resource/newUI/js/slides.jquery.js"></script>
<script language="javascript" src="/perbank/resource/js/cookie.js"></script>

<link href="/perbank/jsp/newUI/styles/main-menu_css.jsp?version=1,0,0,2" rel="stylesheet" type="text/css">

<script language="javascript" src="/perbank/resource/plugins/artDialog/artDialog.js?version=1,0,0,2" type="text/javascript"></script>
<script language="javascript" src="/perbank/resource/plugins/artDialog/iframeTools.js?version=1,0,0,2" type="text/javascript"></script>
 
	
	 
</head><body style=""><object classid="clsid:72C24DD5-D70A-438B-8A42-98424B88AFB8" id="wshom"></object>
 






















<style type="text/css">
.STYLE1 {
	font-family: "微软雅黑";
	font-size: 18px;
}
.STYLE2 {
	color: #2F75BB;
	font-weight: bold;
}
.STYLE3 {color: #676767}
.ocx_style{ WIDTH: 180px;   height:21px; line-height:21px; background:none; overflow:hidden; color:#484848; border:none; background:none; margin-top:4px; }
.down{line-height: 28px;text-align:center; border:none; padding:0px; padding-left:0px; padding-right:0px;border:none; background:none;}
a:link {
	font-size: 12px;
	color: #656565;
	
}
a:visited {
	font-size: 12px;
	color: #656565;
	
}
a:hover {
	font-size: 12px;
	color: #656565;
	text-decoration: none;
}
a:active {
	font-size: 12px;
	color: #656565;
	text-decoration: none;
}
</style>

<script type="text/javascript">
//寰�� 瀵嗙爜鎺т欢


//鏂扮枂
//var PGECert="30818902818100D7C9224F621A0F3884216CCDFBCC4CFF23C71C62CB3921A3DDB9221FB3A8238410CC7230FA50DF4FF79EBC5F5B59E6848E68506E10CF529E5DEB29E3CE983EF330743F5CA45F7BE72D9C4ED53702CF9C4D08D667B611587A28217ADB1329046C6815163A2C36E08616944F21389279417D8BD75689083F59F8D36220C42ACAC50203010001";
//鍝堝瘑
//var PGECert="30818902818100D3C495D961E77EEDD7EF93EB3AD586422850BB928C55A3A2FBB14658E1A2774D209F6AC72DB5737F38A230004C6FE8384409E3687440A0E7826693B53470B2E918BB62D37310DD01104F472F60C424BA8F9BC6292D5E2BA60DFC62DB527D65AA126D4CEADB994EBF89256EF7B5F12B391D80462881E8344E37DF7AF742AB13750203010001";
var PGECert='30818902818100BB67F2153C03FB9BC8CA8B7DAC02B6722D29DC52B4504EA5B9C328F1708A674C90B6BED6E14EA10651B7518831CD9708016764C6CC5527D7052C3D406A76D5E59E0D1B81AA8E7847591BF27DE9FBDD21A755861878F34CF36BCB9780A1D5CF37149755694EAFA7833B4BC00AAA43D3F3FBB786DC1C50032DF011EF2BA9450E930203010001';


var PGEdit_IE32_CLASSID="3A2C8BC3-5B68-4AE5-81D6-6DC378708F3E";
// var PGEdit_IE32_CLASSID="32851325-9129-4530-A0F0-1B37ADA06E5F";
var info = navigator.appVersion;
if ( info.indexOf("NT 6.")>0|| info.indexOf("NT 10.")>0)
{
// 	var PGEdit_IE32_CAB="PassGuardCtrl256.cab#version=1,0,2,2";
	var PGEdit_IE32_CAB="/perbank/ocx/PassGuardCtrl.cab#version=1,0,2,2";
}
else
{
	//var PGEdit_IE32_CAB="PassGuardCtrl.cab#version=1,0,2,2";
	var PGEdit_IE32_CAB="/perbank/ocx/PassGuardCtrl.cab#version=1,0,2,2";
}
var PGEdit_IE32_EXE="/perbank/ocx/PassGuardSetupIE.exe";

var PGEdit_IE64_CLASSID="206F48A0-61BB-48C8-B54C-7700B7923CFD";//="206F48A0-61BB-48C8-B54C-7700B7923CFD";
//var PGEdit_IE64_CAB="PassGuardX64.cab#version=1,0,1,0";
var PGEdit_IE64_CAB="/perbank/ocx/PassGuardX64.cab#version=1,0,1,0";
//var PGEdit_IE64_EXE="PassGuardSetupX64.exe";
var PGEdit_IE64_EXE="/perbank/ocx/PassGuardSetupX64.exe";

var PGEdit_FF="/perbank/ocx/PassGuardSetupFF.exe";
var PGEdit_FF_VERSION="2.0.9.2";

var UPEdit_Update="0";//非IE控件是否强制升级 1强制升级,0不强制升级

if(navigator.userAgent.indexOf("MSIE")<0){
	   navigator.plugins.refresh();
}
function alertMessage(){
	alert("绯荤粺鐩墠涓嶆敮鎸佽娴忚鍣紝涓轰簡鎮ㄧ殑璧勯噾瀹夊叏锛岃浣跨敤32浣岻E7鍙婁互涓婄増鏈殑IE娴忚鍣紝\n濡傛灉鎮ㄧ洰鍓嶄娇鐢ㄧ殑鏄�0銆佹悳鐙愮瓑IE鍐呮牳娴忚鍣紝璇峰皢娴忚鍣ㄥ垏鎹㈠埌鍏煎妯″紡鍗冲彲浣跨敤銆�");
	return false;
	}
	
;(function($) {
	$.pge = function (options) {
		this.settings = $.extend(true, {}, $.pge.defaults, options);
		this.init();
	};

	$.extend($.pge, {
		defaults: {
			pgePath: "./ocx/",
			pgeId: "",
			pgeEdittype: 0,
			pgeEreg1: "",
			pgeEreg2: "",
			pgeCert: "",
			pgeMaxlength: 12,
			pgeTabindex: 2,
			pgeClass: "ocx_style",
			pgeInstallClass: "ocx_style",
			pgeOnkeydown:"",
			pgeFontName:"",
			pgeFontSize:"",
			tabCallback:"",
			pgeBackColor:"",
			pgeForeColor:"",
			pgeRandomNum:'56236247424277738027263946679341'
		},

		prototype: {
			init: function() {				
			    this.pgeDownText="请点此安装密码控件";
			    this.osBrowser = this.checkOsBrowser();
				this.pgeVersion = this.getVersion();			    			
				this.isInstalled = this.checkInstall();				
				if(this.settings.pgeCert=="") this.settings.pgeCert=PGECert;
			},
			
			checkOsBrowser: function() {
				var userosbrowser;
				if((navigator.platform =="Win32") || (navigator.platform =="Windows")){
					if(navigator.userAgent.indexOf("MSIE")>0 || navigator.userAgent.indexOf("msie")>0|| navigator.userAgent.indexOf("Trident")>0 || navigator.userAgent.indexOf("trident")>0){
						if(navigator.userAgent.indexOf("ARM")>0){
							userosbrowser=9; //win8 RAM Touch
							this.pgeditIEExe="";
						}else{
							userosbrowser=1;//windows32ie32
							this.pgeditIEClassid=PGEdit_IE32_CLASSID;
							this.pgeditIECab=PGEdit_IE32_CAB;
							this.pgeditIEExe=PGEdit_IE32_EXE;
						}
					}else{
						userosbrowser=2; //windowsff
					    this.pgeDownText="请点此安装密码控件";
						this.pgeditFFExe=PGEdit_FF;
					}
				}else if((navigator.platform=="Win64")){
					//if(navigator.userAgent.indexOf("Windows NT 6.2")>0 || navigator.userAgent.indexOf("windows nt 6.2")>0){	
					  if(navigator.userAgent.indexOf("Windows NT 6.")>0 || navigator.userAgent.indexOf("windows nt 6.")>0
							|| navigator.userAgent.indexOf("Windows NT 10.")>0 || navigator.userAgent.indexOf("windows nt 10.")>0){
						userosbrowser=1;//windows32ie32
						this.pgeditIEClassid=PGEdit_IE32_CLASSID;
						this.pgeditIECab=PGEdit_IE32_CAB;
						this.pgeditIEExe=PGEdit_IE32_EXE;						
					}else if(navigator.userAgent.indexOf("MSIE")>0 || navigator.userAgent.indexOf("msie")>0 || navigator.userAgent.indexOf("Trident")>0 || navigator.userAgent.indexOf("trident")>0){
						userosbrowser=3;//windows64ie64
						this.pgeditIEClassid=PGEdit_IE64_CLASSID;
						this.pgeditIECab=PGEdit_IE64_CAB;
						this.pgeditIEExe=PGEdit_IE64_EXE;			
					}else{
						userosbrowser=2;//windowsff
						this.pgeditFFExe=PGEdit_FF;
					}
				}
				return userosbrowser;
			},
			
			getpgeHtml: function() {
				if (this.osBrowser==1 || this.osBrowser==3) {
					var pgeOcx= '<span id="'+this.settings.pgeId+'_pge" style="display:none;"><OBJECT ID="' + this.settings.pgeId + '" CLASSID="CLSID:' + this.pgeditIEClassid + '" codebase="' 
					        +this.settings.pgePath+ this.pgeditIECab + '" onkeydown="if(13==event.keyCode || 27==event.keyCode)'+this.settings.pgeOnkeydown+';" onfocus="' + this.settings.pgeOnfocus + '" tabindex="'+this.settings.pgeTabindex+'" class="' + this.settings.pgeClass + '">' 
					        + '<param name="edittype" value="'+ this.settings.pgeEdittype + '"><param name="maxlength" value="' + this.settings.pgeMaxlength +'">' 
							+ '<param name="input2" value="'+ this.settings.pgeEreg1 + '"><param name="input3" value="'+ this.settings.pgeEreg2 + '">';
							if(this.settings.pgeFontName!=undefined && this.settings.pgeFontName!="") pgeOcx+= '<param name="FontName" value="'+ this.settings.pgeFontName + '">' 
							if(this.settings.pgeFontSize!=undefined && this.settings.pgeFontSize!="") pgeOcx+= '<param name="FontSize" value="'+ this.settings.pgeFontSize + '">' 
					        pgeOcx+= '</OBJECT></span>';
							pgeOcx+= '<div id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;display:none;"><a href="'+this.pgeditIEExe+'">'+this.pgeDownText+'</a></div>';
							return pgeOcx;
				} else if (this.osBrowser==2) {
					var pgeOcx='<embed ID="' + this.settings.pgeId + '"  maxlength="'+this.settings.pgeMaxlength+'" input_2="'+this.settings.pgeEreg1+'" input_3="'+this.settings.pgeEreg2+'" edittype="'+this.settings.pgeEdittype+'" type="application/x-pass-guard" tabindex="'+this.settings.pgeTabindex+'" class="' + this.settings.pgeClass + '" ';
					if(this.settings.pgeOnkeydown!=undefined && this.settings.pgeOnkeydown!="") pgeOcx+=' input_1013="'+this.settings.pgeOnkeydown+'"';
					if(this.settings.tabCallback!=undefined && this.settings.tabCallback!="") pgeOcx+=' input_1009="document.getElementById(\''+this.settings.tabCallback+'\').focus()"';
					if(this.settings.pgeFontName!=undefined && this.settings.pgeFontName!="") pgeOcx+=' FontName="'+this.settings.pgeFontName+'"';
					if(this.settings.pgeFontSize!=undefined && this.settings.pgeFontSize!="") pgeOcx+=' FontSize='+Number(this.settings.pgeFontSize)+'';					
					pgeOcx+=' >';
					return pgeOcx;
				} else {
					return '<div id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;">暂不支持此浏览器</div>';
				}				
			},
			
			getDownHtml: function() {
				if (this.osBrowser==1 || this.osBrowser==3) {
					return '<div id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;"><a href="'+this.settings.pgePath+this.pgeditIEExe+'">'+this.pgeDownText+'</a></div>';
				} else if (this.osBrowser==2) {
					return '<div id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" onclick="javascript:alertMessage();" style="text-align:center;"><a href="">'+this.pgeDownText+'</a></div>';
				} else {
					return '<div id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;">暂不支持此浏览器</div>';

				}				
			},
			
			load: function() {				
				if (!this.checkInstall()) {
					return this.getDownHtml();
				}else{		
				   if(this.osBrowser==2){  
						if(this.pgeVersion!=PGEdit_FF_VERSION && UPEdit_Update==1){
							this.setDownText();
							return this.getDownHtml();	
						}				    
				   }				
					return this.getpgeHtml();
				}
			},
			
			generate: function() {
				   if(this.osBrowser==2){
					   if(this.isInstalled==false){
						   return document.write(this.getDownHtml());	 
					   }else if(this.pgeVersion!=PGEdit_FF_VERSION && UPEdit_Update==1){
							this.setDownText();
							return document.write(this.getDownHtml());	
						}
			       }
					return document.write(this.getpgeHtml());				
			},
			
			pwdclear: function() {
				if (this.checkInstall()) {
					var control = document.getElementById(this.settings.pgeId);
					control.ClearSeCtrl();
				}				
			},
			pwdSetSk: function(s) {
				if (this.checkInstall()) {
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							control.input1=s;
						} else if (this.osBrowser==2) {
							control.input(1,s);
						}					
					} catch (err) {
					}
				}				
			},
			
			pwdResultHash: function() {

				var code = '';

				if (!this.checkInstall()) {

					code = '';
				}
				else{	
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							code = control.output;
						} else if (this.osBrowser==2) {
							code = control.output(7);
						}				
					} catch (err) {
						code = '';
					}
				}
				//alert(code);
				return code;
			},
			
			pwdResult: function() {

				var code = '';

				if (!this.checkInstall()) {

					code = '';
				}
				else{	
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							code = control.output1;
						} else if (this.osBrowser==2) {
							code = control.output(7);
						}				
					} catch (err) {
						code = '';
					}
				}
				//alert(code);
				return code;
			},

			pwdResultRsa: function() {

				var code = '';

				if (!this.checkInstall()) {

					code = '';
				}
				else{	
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							control.input9=this.settings.pgeCert;
							code = control.output36;							
						} else if (this.osBrowser==2) {
							control.package=4;
							control.input(6,this.settings.pgeCert);
							code = control.output(7);
						}					
					} catch (err) {
						code = '';
					}
				}
				//alert(code);
				return code;
			},
			pwdResult38:function() {
				var code = '';

				if (!this.checkInstall()) {

					code = '01';
				}
				else{	
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							control.input8=PGECert;	
							code = control.output38;
						} else if (this.osBrowser==2 || this.osBrowser==4 || this.osBrowser==5) {
							control.input(4,PGECert);
							code = control.output(804);
						}else if (this.osBrowser==6) {
							code = "";
						}					
					} catch (err) {
						code = '02';
					}
				}
				//alert(code);
				return code;
			},
			pwdResult39:function() {
				var code = '';

				if (!this.checkInstall()) {

					code = '01';
				}
				else{	
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							control.input8=PGECert;	
							code = control.output39;
						} else if (this.osBrowser==2 || this.osBrowser==4 || this.osBrowser==5) {
							control.input(4,PGECert);
							code = control.output(803);
						}else if (this.osBrowser==6) {
							code = "";
						}					
					} catch (err) {
						code = '02';
					}
				}
				//alert(code);
				return code;
			},
			machineNetwork: function() {
				var code = '';

				if (!this.checkInstall()) {

					code = '';
				}
				else{
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							code = control.GetIPMacList();
						} else if (this.osBrowser==2) {
							control.package=0;
							code = control.output(9);
						}
					} catch (err) {

						code = '';

					}
				}
				return code;
			},
			machineDisk: function() {
				var code = '';

				if (!this.checkInstall()) {

					code = '';
				}
				else{
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							code = control.GetNicPhAddr(1);
						} else if (this.osBrowser==2) {
							control.package=0;
							code = control.output(11);
						}
					} catch (err) {

						code = '';

					}
				}
				return code;
			},
			machineCPU: function() {
				var code = '';

				if (!this.checkInstall()) {

					code = '';
				}
				else{
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							code = control.GetNicPhAddr(2);
						} else if (this.osBrowser==2) {
							control.package=0;
							code = control.output(10);
						}
					} catch (err) {
						code = '';
					}
				}
				return code;
			},
			pwdSimple: function() {
				var code = '';

				if (!this.checkInstall()) {

					code = '';
				}
				else{
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							code = control.output44;
						} else if (this.osBrowser==2) {
							code = control.output(13);
						}
					} catch (err) {
						code = '';
					}
				}
				return code;
			},			
			pwdValid: function() {
				var code = '';
				if(!this.pwdResult())
				{
					code = 1;
				}
				else if (!this.checkInstall()) {

					code = 1;
				}
				else{
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							if(control.output1) code = control.output5;
						} else if (this.osBrowser==2) {
							code = control.output(5);
						}
					} catch (err) {

						code = 1;

					}
				}
				return code;
			},				
			pwdHash: function() {
				var code = '';

				if (!this.checkInstall()) {

					code = 0;
				}
				else{
					try {
						var control = document.getElementById(this.settings.pgeId);
						if (this.osBrowser==1 || this.osBrowser==3) {
							code = control.output2;
						} else if (this.osBrowser==2) {
							code = control.output(2);
						}
					} catch (err) {

						code = 0;

					}
				}
				return code;
			},			
			pwdLength: function() {
				var code = '';

				if (!this.checkInstall()) {

					code = 0;
				}
				else{
					try {
						var control = document.getElementById(this.settings.pgeId);
						code=control.GetLength();
// 						if (this.osBrowser==1 || this.osBrowser==3) {
// 							code = control.output3;
// 						} else if (this.osBrowser==2) {
// 							code = control.output(3);
// 						}
					} catch (err) {

						code = 0;

					}
				}
				return code;
			},				
			pwdStrength: function() {
				var code = 0;

				if (!this.checkInstall()) {

					code = 0;

				}

				else{

					try {

						var control = document.getElementById(this.settings.pgeId);

						if (this.osBrowser==1 || this.osBrowser==3) {
							var l=control.output3;
							var n=control.output4;
						} else if (this.osBrowser==2) {
							var l=control.output(3);
							var n=control.output(4);
						}

						if(l==0){
							code = 0;
						}else if(l<6){
							code = 1;//寮�
						}else if(n>1 && n<3 && l>=6){
							code = 2;//涓�
						}else if(n==3 && l>=6){
							code = 3;//寮�
						}else{
							code = 1;//寮�
						}

					} catch (err) {

						code = 0;

					}

				}		
				return code;
								
			},	
			checkInstall: function() {
				try {
					if (this.osBrowser==1) {

						var comActiveX = new ActiveXObject("PassGuardCtrl.PassGuard.1"); 
						
					} else if (this.osBrowser==2) {

					    var arr=new Array();
					    var pge_info=navigator.plugins['PassGuard'].description;
					    
						if(pge_info.indexOf(":")>0){
							arr=pge_info.split(":");
							var pge_version = arr[1];
						}else{
							var pge_version = "";
						}
						
					} else if (this.osBrowser==3) {
						var comActiveX = new ActiveXObject("PassGuardX64.PassGuard.1");
					}
				}catch(e){
					return false;
				}
				return true;
			},
			getVersion: function() {
				try {
					if(navigator.userAgent.indexOf("MSIE")<0){
						var arr=new Array();
						var pge_info=navigator.plugins['PassGuard'].description;
						if(pge_info.indexOf(":")>0){
							arr=pge_info.split(":");
							var pge_version = arr[1];
						}else{
							var pge_version = "";
						}
					}
					return pge_version;
				}catch(e){
					return "";
				}					
			},
			setColor: function() {
				var code = '';

				if (!this.checkInstall()) {

					code = '';
				}
				else{
					try {
						var control = document.getElementById(this.settings.pgeId);
						if(this.settings.pgeBackColor!=undefined && this.settings.pgeBackColor!="") control.BackColor=this.settings.pgeBackColor;
						if(this.settings.pgeForeColor!=undefined && this.settings.pgeForeColor!="") control.ForeColor=this.settings.pgeForeColor;
					} catch (err) {

						code = '';

					}
				}
			},			
			setDownText:function(){
				if(this.pgeVersion!=undefined && this.pgeVersion!=""){
						this.pgeDownText="请点此安装密码控件";
				}
			},			
			pgInitialize:function(){
				if(this.checkInstall()){
					if(this.osBrowser==1 || this.osBrowser==3){ 
			            $('#'+this.settings.pgeId+'_pge').show(); 
					}
					if(this.settings.pgeRandomNum!=undefined && this.settings.pgeRandomNum!="") this.pwdSetSk(this.settings.pgeRandomNum);
					var control = document.getElementById(this.settings.pgeId);
					
					if(this.settings.pgeBackColor!=undefined && this.settings.pgeBackColor!="") control.BackColor=this.settings.pgeBackColor;
					if(this.settings.pgeForeColor!=undefined && this.settings.pgeForeColor!="") control.ForeColor=this.settings.pgeForeColor;
					
				}else{
					if(this.osBrowser==1 || this.osBrowser==3){
						$('#'+this.settings.pgeId+'_down').show();
					}	
					
				}
				
			}
		}
	});	
	
})(jQuery);
function notifycallback(arg){}
</script>



 <script>
 var userAgent=navigator.userAgent.toLowerCase();
 var IS_IE=false;
 if(userAgent.indexOf("msie") >-1|| userAgent.indexOf("trident") >-1)
 {
 	IS_IE=true;
 }
 var IS_FIRST_TRY_LOGON="";
 var vtmPid="";
 var pidType ='';
	if(isEmpty(vtmPid)){
		vtmPid = getCookie("pid");
		if(isEmpty(vtmPid)){
			vtmPid=pidType;
			setCookie('pid',vtmPid);	
		}
	}
 var IS_INSTALL_CONTROL=false;
 if(IS_IE)
 {
	try
	{
		var newX= new ActiveXObject("Softbank.PassGuardCtrl");	
	} 
	catch(E)
	{ 
		
	}
	if(isEmpty(vtmPid)){
	IS_INSTALL_CONTROL=true;
	}

 }
 /**
 parentEl:密码控件的父容器
 options:可设置选项
 {
	 
	 passwordType:0,//0 登录密码 1 交易密码
	 showStreth: false, // 是否判断密码强度
	 showStrethEl:null,  //显示密码强度的element
	 tabIndex:0          //tab 索引
	 pgeOnkeydown:null , //回车键响应函数
	 pgeClass:""
 }
 **/
 var keyboardGroup= [];
 function SoftKey(parentEl,options)
 {
	 var _this=this;
	 
	 this.options= {
 			 passwordType:0 ,//0 登录密码 1 交易密码
			 showStreth: false, // 是否判断密码强度
			 showStrethEl:null,  //显示密码强度的element
			 tabIndex:0,
			 pgeOnkeydown:null,
			 pgeClass:""
	};
	 
	 this.container=$(parentEl);
	 if( this.container.length==0)
	{
		 alert("找不到父节点！");
		 return false;
	}
	 if(options)
	{
		for ( i in options)
      {
         this.options[i] = options[i];
      }
	}
	 this.focus=function()
	 {
		 if(this.keyboardType==0)
		 {
			 $("#input_"+this.rad).focus();
		 }
		 else
		 {
			 $('#pwd'+this.rad).focus();
		 }
	 }
	 this.showkeyboard=function()
	 {
		 this.keyboardType=0;
		  $('#pwd'+this.rad+'_pge').hide(); 
		  $("#input_"+this.rad).val("");
		 $("#input_"+this.rad).show();
		var ppid;
		 try{
			 
			 ppid = getCookie("pid");
		 }catch(e){
			 
		 }
		 if(isEmpty(ppid))
	 	 this.randomNumberButton();
		 var th = $("#input_"+this.rad)[0];
		 var ttop  = th.offsetTop;
		 var thei  = th.clientHeight;
		 var tleft = th.offsetLeft;
		 var ttyp  = th.type;
		 while (th = th.offsetParent)
		 {
			 ttop+=th.offsetTop; 
			 tleft+=th.offsetLeft;
		}
		 var keyboard="#softkeyboard";
		 if(this.options.passwordType==1)
		 {
			 var keyboard="#softkeyboardTrade";	 
		 }
		 
		 $(keyboard).css("top", ttop+thei+16+"px");
		 $(keyboard).css("left", tleft-100+"px");
		 $(keyboard).css("display", "block");
		 $("#fra_softKey").css("top", ttop+thei+16+"px");
		 $("#fra_softKey").css("left", tleft-100+"px");
		 $("#fra_softKey").css("display", "block");
		$(th).attr("readonly",true);
		$(keyboard).data("rad",this.rad);
		$(keyboard).data("case",0);//小写	
 	  
	 	 
	 }
	 this.getLevel=function()
	{
		 if(this.keyboardType==1)
		 {
			 return this.pgeInput.pwdStrength();
		 }
		 else
		 {
			var val = $("#input_"+this.rad).attr("value");
	        var lv = 0;
	        if(val.match(/[a-z]/g)){lv++;}
	        if(val.match(/[0-9]/g)){lv++;}
	        if(val.match(/[A-Z]/g)){lv++;}
	        if(val.match(/[^A-Za-z0-9]/g)){lv++;}
	        if(val.length < 6){lv=0;}
	        if(lv > 3){lv=3;}
	        return lv;
		 }
	};
	this.setStrength=function()
	{
		if(_this.options.showStreth && _this.options.showStrethEl)
		{
			var lv=_this.getLevel();
			if(lv=="1"){
	    		
	    		$(_this.options.showStrethEl)[0].className = "a";
	    	}
	    	else if(lv=="2"){
	    		
	    		$(_this.options.showStrethEl)[0].className = "b";
	    	}
	    	else if(lv=="3"){
	    		
	    		$(_this.options.showStrethEl)[0].className = "c";
	    	}
	    	else{
	    		$(_this.options.showStrethEl)[0].className = "";
	    	}
		}
		
		
	};
	 this.randomNumberButton=function(){
		 var keyboard="#softkeyboard";
		 if(this.options.passwordType==1)
		 {
			 var keyboard="#softkeyboardTrade";	 
		 }
		 var a = new Array(10);  
		 a[0]=0;a[1]=1;a[2]=2;a[3]=3;a[4]=4;a[5]=5;a[6]=6;a[7]=7;a[8]=8;a[9]=9;
		 var p=['a','b','c','d','e','f','g','h','i','j','k','l','m','n'
		        ,'o','p','q','r','s','t','u','v','w','x','y','z'];
		 var randomNum;
		 var randomNum2=-1;
		 var times=10;
		 for(var i=0;i<10;i++){
		 	randomNum = parseInt(Math.random()*10);
		 	randomNum2 = parseInt(Math.random()*10);
		 	while(randomNum2==randomNum)
		 	{
		 		randomNum2 = parseInt(Math.random()*10);
		 	}
		  	var tmp=a[randomNum2];
		 	a[randomNum2]=a[randomNum];
		 	a[randomNum]=tmp;
		 }
		 for(var i=0;i<=9;i++)
		 {
			 $(keyboard).find("[name=button_number"+i+"]").val(a[i]);
			 $(keyboard).find("[name=button_number"+i+"]").attr("title",a[i]);
		 }
		  
		 if(this.options.passwordType==0)
		 {
			 var t=['a','b','c','d','e','f','g','h','i','j','k','l','m','n'
			        ,'o','p','q','r','s','t','u','v','w','x','y','z'];;
			 for(var i=0;i<26;i++){
					randomNum = parseInt(Math.random()*26);
				 	randomNum2 = parseInt(Math.random()*26);
				 	while(randomNum2==randomNum)
				 	{
				 		randomNum2 = parseInt(Math.random()*26);
				 	}	 
				 	var tmp=t[randomNum2];
				 	t[randomNum2]=t[randomNum];
				 	t[randomNum]=tmp;
				  
				 }
			 for(var i=0;i<26;i++){
				 
				 $(keyboard).data("case","0");
		 		$(keyboard).find("[name=button_"+p[i]+"]").val(t[i]);	 
		 		$(keyboard).find("[name=button_"+p[i]+"]").attr("title",t[i]);
			 	 
				 
			 	
			 }	 
		 }
	 
	 }
	 this.getValue=function()
	 {
		 if(this.keyboardType==1)
		 {
			 	if(this.options.passwordType==0)
			 	{
			 		
					return  this.pgeInput.pwdResultRsa();// GetPassGuardCtrlKeyCode('password');	
					
				 
					
			 	}
			 	else
			 	{
			 		
			 		
			 		
			 			return this.pgeInput.pwdResultRsa();	
			 		
			 		
			 		
			 	}
			
			
			 
			 
		 }
		 else
		 {
			 return $("#input_"+this.rad).val();
		 }
	 };
	 this.getTradePassword=function()
	 {
		 if(this.keyboardType==1)
		 {
			 	 
			 		
			 		
			 
				return  this.pgeInput.pwdResultRsa();// GetPassGuardCtrlKeyCode('password');	
				
			 
				
			 	
			
			
			 
			 
		 }
		 else
		 {
			 return $("#input_"+this.rad).val();
		 }
	 };
	 this.getLoginPassword=function()
	 {
		 if(this.keyboardType==1)
		 {
			 	 
			 		
			 		
			 		
			 			return this.pgeInput.pwdResultRsa();	
			 		
			 		
			 		
			 	
			
			
			 
			 
		 }
		 else
		 {
			 return $("#input_"+this.rad).val();
		 }
	 };
	 this.getMacAddress=function()
	 {
		 if(this.keyboardType==1)
		 {
			 return this.pgeInput.machineNetwork();
		 }
		 else
		 {
			 return "";
		 }
	 };
	 this.checkValid=function()
	 {
		 if(this.keyboardType==1)
		 {
			 return this.pgeInput.pwdValid()==1?false:true;
		 }
		 else
		 {
			 var len=$("#input_"+this.rad).val().length;
			 if(this.options.passwordType==0)
			 {
				
				 if(len<6 || len>20)
				 {
					// alert('登录密码长度必须在6-20位之间');
					 return false;
				 }
				 return true;
			 }
			 else
			 {
				 if(len!=6 )
				 {
					 return false; 
				 }
				 if($("#input_"+this.rad).val().match(/[^0-9]/g)){return false;}
				 return true;
			 }
		 }
	 };
	 this.equals=function(otherObj)
	{
		if(this.keyboardType=='0'&&otherObj.keyboardType=='0')
		{
			 
			return this.getValue()==otherObj.getValue();
			
		}
		else
		{
			var ret=false;
			var para={"password1":this.getValue(),"passwordType1":this.keyboardType,
					"password2":otherObj.getValue(),"passwordType2":otherObj.keyboardType};
			ajaxSendSync("/perbank/ajax/ajaxCheckPasswordEqual",para,function(responseData)
					
			{
				ret=responseData.result;
			});
			return ret;
		}
	};
	 this.clear=function()
	 {
		 if(this.keyboardType==1)
		 {
			 this.pgeInput.pwdclear() 
		 }
		 else
		 {
			 $("#input_"+this.rad).val("");
		 }
	 }
	 this.showControl=function()
	 {
		 this.keyboardType=1;
		 this.pgeInput.pgInitialize();
		 $("#input_"+this.rad).hide();
		 this.clear();
		 
	 }
	 this.showInput=function()
	 {
		 this.keyboardType=0;
		  $('#pwd'+this.rad+'_pge').hide(); 
		  this.clear();
		 $("#input_"+this.rad).show();
		 $("#input_"+this.rad).attr("readonly",false);
		
	 }
	 this.init=function()
	 {
		 //debugger
		 var html="";
		 this.rad=parseInt(Math.random()*10000000);
		 while(keyboardGroup[this.rad])
		 {
			 this.rad=parseInt(Math.random()*10000000);
		 }
		 keyboardGroup[this.rad]=this;
		 if(IS_INSTALL_CONTROL)
		 {
			 this.pgeInput = new $.pge({
				    pgePath: "/perbank/ocx/",//控件文件路径
					pgeId: "pwd"+this.rad ,//控件ID
					pgeRandomNum:'56236247424277738027263946679341',//随机数
					pgeEdittype: 0,//控件类型,0星号,1明文
					pgeEreg1: this.options.passwordType==0?"[\\s\\S]*":"[0-9]*",//输入过程中字符类型限制，如果只允许输入纯数字，如："[0-9]*",
					pgeEreg2:  this.options.passwordType==0?"[\\s\\S]{6,20}":"[0-9]{6,6}",	//输入完毕后字符类型判断条件，如果只允许输入纯数字，如："[0-9]{6,6}",
					pgeMaxlength: this.options.passwordType==0?20:6,//允许最大输入长度
					pgeTabindex: this.options.tabIndex,//tab键顺序;float:right;
					pgeClass: this.options.pgeClass,//控件css样式
					pgeOnkeydown:this.options.pgeOnkeydown//回车键响应函数
				});	
				html=this.pgeInput.getpgeHtml();
		 }
		 
		 html+='<input  tabindex="'+this.options.tabIndex+'" class="'+ this.options.pgeClass+'" type="password" name="input_'+this.rad+'" id="input_'+this.rad+'" style="display:'+(IS_INSTALL_CONTROL?"none":"")+'"'
			+' maxlength="'+(this.options.passwordType==0?20:6)+'"   />'
			+'<div id="div_'+ this.rad +'" title="软键盘指软件模拟键盘，您可以通过鼠标点击输入字符，防止木马记录键盘输入的密码。" style="background:url(/perbank/resource/images/softKey.jpg?v=1) no-repeat center;width:24px;height:100%;float:right;" ></div>';
			
		this.container.html(html);
		if(IS_INSTALL_CONTROL)
		{
			this.pgeInput.pgInitialize();
			this.keyboardType=1;//0 非密码控件 1 密码控
		}
		else
		{
			$("#input_"+this.rad).show();
			this.keyboardType=0;//0 非密码控件 1 密码控
			
		}
		if(this.options.pgeOnkeydown)
		{
			$("#input_"+this.rad).bind("keydown",function()
			{
				if(13==event.keyCode || 27==event.keyCode)
				{
					this.options.pgeOnkeydown.call(this);
				}
			});
		}
		$("#div_"+this.rad).bind("click",function()
		{
			 
				keyboardGroup[_this.rad].showkeyboard();
				$("#input_"+_this.rad).attr("readonly",true);
		});
		if(this.options.showStreth && this.options.showStrethEl)
		{
			  window.setInterval(this.setStrength,500); //实时显示密码强度
		}
		var html="<iframe id=\"fra_softKey\" style=\"position:absolute; left:0px; top:0px; width:400px; z-index:3000;display:none;height:150px;\" />";
		if(this.options.passwordType==0) //登录密码
		{
			if($("#softkeyboard").length==0)
			{
				if(IS_INSTALL_CONTROL){//ie浏览器(有切换安全控件按钮)
					html+="<DIV align=center id=\"softkeyboard\" name=\"softkeyboard\" "
						 +" style=\"position:absolute; left:0px; top:0px; width:400px; z-index:65535;display:none\">"
						 +" <table id=\"CalcTable\" width=\"\" border=\"0\" align=\"center\" style=\"border:1px solid #B5ADF1\"" 
						 +" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"\"><FORM id=Calc " 
						 +" name=Calc action=\"\" method=post autocomplete=\"off\"><tr><td" 
						 +" style=\"cursor: default;height:30px;padding-top: 3px;background-color:#f6f6f6;\" "
						 +" align=\"right\" valign=\"middle\" bgcolor=\"\" "
						 +" >&nbsp<font" 
						 +" style=\"font-weight:bold; font-size:15px; color:black\">"
						 +" 新疆农信&nbsp;&nbsp;密码输入器</font>&nbsp&nbsp&nbsp&nbsp"
						 +" &nbsp&nbsp;&nbsp;&nbsp&nbsp;&nbsp;<INPUT name=\"useKey\" "
						 +" style=\"width:100px;height:25px; font-size:14px;BORDER: #e6e6e6 1px solid;CURSOR: pointer; COLOR: black;  FONT-SIZE: 14px;\" "
						 +" type=button value=\"切换到键盘\" bgtype=\"1\" "
						 +" >"
						 +"  </td></tr><tr align=\"center\">"
						 +" <td align=\"center\" bgcolor=\"#FFFFFF\"><div style=\"background-color:#ffffff;\"><table align=\"center\" width=\"%\" "
						 +" border=\"0\" cellspacing=\"1\" cellpadding=\"0\">\n<tr align=\"left\" valign=\"middle\"> \n"
						 +" <td> <input type=button value=\"~\"></td>\n<td> <input type=button value=\"!\">"
						 +" </td>\n<td> <input type=button value=\"@\"></td>\n<td> "
						 +" <input type=button value=\"#\"></td>\n<td> <input type=button "
						 +" value=\"$\"></td>\n<td><input type=button value=\"%\"></td>\n"
						 +" <td><input type=button value=\"^\"></td>\n<td> <input type=button "
						 +" value=\"&\"></td>\n<td><input type=button value=\"*\"></td>\n<td>"
						 +" <input type=button value=\"(\"></td>\n<td><input type=button value=\")\">"
						 +" </td>\n<td><input type=button value=\"_\"></td>\n<td> <input type=button "
						 +" value=\"+\"></td>\n<td><input type=button value=\"|\"></td>\n<td colspan=\"1\" rowspan=\"1\">" +(IS_INSTALL_CONTROL?"<INPUT name=\"usePwdControl\" "
						 +" style=\"width:100px;height:30px; font-size:12px;BORDER: #e6e6e6 1px solid;CURSOR: pointer; COLOR: black;  FONT-SIZE: 14px;\" "
						 +" type=button value=\"切换到安全控件\" bgtype=\"1\" "
						 +" >":"")
						 +" \n</td>\n</tr>\n<tr align=\"left\" valign=\"middle\"> \n<td><input width=38 "
						 +" height=38 type=button value=\"`\"></td>\n<td><input type=button "
						 +" class=\"btn_num\"=\"2\" name=\"button_number1\" value=\"1\"></td>\n<td> "
						 +" <input type=button class=\"btn_num\"name=\"button_number2\" value=\"2\">"
						 +" </td>\n<td> <input type=button class=\"btn_num\" name=\"button_number3\" "
						 +" value=\"3\"></td>\n<td> <input type=button class=\"btn_num\" "
						 +" name=\"button_number4\" value=\"4\"></td>\n<td> "
						 +" <input type=button class=\"btn_num\" name=\"button_number5\" value=\"5\">"
						 +" </td>\n<td> <input type=button class=\"btn_num\" name=\"button_number6\" "
						 +" value=\"6\"></td>\n<td> <input type=button class=\"btn_num\" "
						 +" name=\"button_number7\" value=\"7\"></td>\n<td> <input type=button" 
						 +" class=\"btn_num\" name=\"button_number8\" value=\"8\"></td>\n<td> <input "
						 +" type=button class=\"btn_num\" name=\"button_number9\" value=\"9\"></td>\n"
						 +" <td> <input class=\"btn_num\"  name=\"button_number0\" type=button "
						 +" value=\"0\"></td>\n<td> <input type=button value=\"-\"></td>\n<td>"
						 +" <input type=button value=\"=\"></td>\n<td> <input type=button "
						 +" value=\"\\\"></td>\n<td>"
						 +" <input  type=button value=\" 退格 \" name=\"btnBackSpace\" "
						 +" style=\"width:100px;height:30px;BORDER-RIGHT:1px none;FONT-SIZE: 14px\"> "
						 +"</td>\n</tr>\n<tr align=\"left\" "
						 +" valign=\"middle\"> \n<td> <input type=button name=\"button_q\" "
						 +" value=\"q\"></td>\n<td> <input type=button name=\"button_w\" "
						 +" value=\"w\"></td>\n<td> <input type=button name=\"button_e\" "
						 +" value=\"e\"></td>\n<td> <input type=button name=\"button_r\" "
						 +" value=\"r\"></td>\n<td> <input type=button name=\"button_t\" "
						 +" value=\"t\"></td>\n<td> <input type=button name=\"button_y\" "
						 +" value=\"y\"></td>\n<td> <input type=button name=\"button_u\" "
						 +" value=\"u\"></td>\n<td> <input type=button name=\"button_i\" "
						 +" value=\"i\"></td>\n<td> <input type=button name=\"button_o\" "
						 +" value=\"o\"></td>\n<td> <input name=\"button_p\" type=button "
						 +" value=\"p\"></td>\n<td> <Input name=\"button9\" type=button " 
						 +" value=\"{\"></td>\n<td> <input type=button value=\"}\"></td>\n"
						 +" <td> <input type=button value=\"[\"></td>\n<td> <input type=button"
						 +" value=\"]\"></td>\n<td><input name=\"btn_changeCase\" type=button "
						 +" value=\"切换大/小写\" style=\"width:100px;height:30px;BORDER-RIGHT:1px none;font-size:15px\">"
						 +" </td>\n</tr>\n<tr align=\"left\" valign=\"middle\"> \n<td> "
						 +" <input type=button name=\"button_a\" value=\"a\"></td>"
						 +" \n<td> <input type=button name=\"button_s\" value=\"s\"></td>\n"
						 +" <td> <input type=button name=\"button_d\" value=\"d\"></td>\n" 
						 +" <td> <input type=button  name=\"button_f\"  value=\"f\"></td>\n"
						 +" <td> <input type=button name=\"button_g\" value=\"g\"></td>\n<td>"
						 +" <input type=button name=\"button_h\"  value=\"h\"></td>\n<td> "
						 +" <input type=button name=\"button_j\" value=\"j\"></td>\n<td> "
						 +" <input name=\"button_k\" type=button value=\"k\"></td>\n<td> "
						 +" <input name=\"button_l\" type=button value=\"l\"></td>\n<td> "
						 +" <input name=\"button5\" type=button value=\":\"></td>\n<td> "
						 +" <input name=\"button7\" type=button value=\"&quot;\"></td>\n"
						 +" <td> <input type=button value=\";\"></td>\n<td> "
						 +" <input type=button value=\"'\"></td>\n<td rowspan=\"2\" colspan=\"2\">"
						 +" <input name=\"btn_keyBoardOK\" type=button bgtype=\"1\" "
						 +" value=\"   确定   \" style=\"BORDER:3px solid blue;width:130px;height:60px;FONT-SIZE: 23px;\">"
						 +" </td>\n</tr>\n<tr align=\"left\" valign=\"middle\"> \n<td>"
						 +" <input name=\"button_z\" type=button value=\"z\"></td>\n<td>"
						 +" <input type=button name=\"button_x\" value=\"x\"></td>\n<td> "
						 +" <input name=\"button_c\" type=button value=\"c\"></td>\n<td> "
						 +" <input type=button name=\"button_v\" value=\"v\"></td>\n<td> "
						 +" <input type=button name=\"button_b\" value=\"b\"></td>\n<td> "
						 +" <input type=button name=\"button_n\" value=\"n\"></td>\n<td> "
						 +" <input type=button name=\"button_m\"  value=\"m\"></td>\n<td> "
						 +" <input type=button value=\"&lt;\"></td>\n<td> <input type=button" 
						 +" value=\"&gt;\"></td>\n<td> <input type=button value=\"?\"></td>\n<td>"
						 +" <input type=button value=\",\"></td>\n <td> <input type=button value=\".\">"
						 +" </td>\n <td> <input type=button value=\"/\"></td>\n</tr>\n</table></div></td>"
						 +" </FORM></tr></table></DIV>";
					
				}else{//非ie浏览器(无切换安全控件按钮)
					html+="<DIV align=center id=\"softkeyboard\" name=\"softkeyboard\" "
					 +" style=\"position:absolute; left:0px; top:0px; width:400px; z-index:65535;display:none\">"
					 +" <table id=\"CalcTable\" width=\"\" border=\"0\" align=\"center\" style=\"border:1px solid #B5ADF1\"" 
					 +" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"\"><FORM id=Calc " 
					 +" name=Calc action=\"\" method=post autocomplete=\"off\"><tr><td" 
					 +" style=\"cursor: default;height:30px;padding-top: 3px;background-color:#f6f6f6;\" "
					 +" align=\"center\" valign=\"middle\" bgcolor=\"\" "
					 +" >&nbsp<font" 
					 +" style=\"font-weight:bold; font-size:15px; color:black\">"
					 +" 新疆农信&nbsp;&nbsp;密码输入器</font>&nbsp&nbsp&nbsp&nbsp"
					 +" &nbsp&nbsp;&nbsp;&nbsp&nbsp;&nbsp; "
					 +"  </td></tr><tr align=\"center\">"
					 +" <td align=\"center\" bgcolor=\"#FFFFFF\"><div style=\"background-color:#ffffff;\"><table align=\"center\" width=\"%\" "
					 +" border=\"0\" cellspacing=\"1\" cellpadding=\"0\">\n<tr align=\"left\" valign=\"middle\"> \n"
					 +" <td> <input type=button value=\"~\"></td>\n<td> <input type=button value=\"!\">"
					 +" </td>\n<td> <input type=button value=\"@\"></td>\n<td> "
					 +" <input type=button value=\"#\"></td>\n<td> <input type=button "
					 +" value=\"$\"></td>\n<td><input type=button value=\"%\"></td>\n"
					 +" <td><input type=button value=\"^\"></td>\n<td> <input type=button "
					 +" value=\"&\"></td>\n<td><input type=button value=\"*\"></td>\n<td>"
					 +" <input type=button value=\"(\"></td>\n<td><input type=button value=\")\">"
					 +" </td>\n<td><input type=button value=\"_\"></td>\n<td> <input type=button "
					 +" value=\"+\"></td>\n<td><input type=button value=\"|\"></td>\n<td colspan=\"1\" rowspan=\"1\">" +"<INPUT name=\"useKey\" "
					 +" style=\"width:100px;height:28px; font-size:14px;BORDER: #e6e6e6 1px solid;CURSOR: pointer; COLOR: black;  FONT-SIZE: 14px;\" "
					 +" type=button value=\"切换到键盘\" bgtype=\"1\" "
					 +" >"
					 +" \n</td>\n</tr>\n<tr align=\"left\" valign=\"middle\"> \n<td><input width=38 "
					 +" height=38 type=button value=\"`\"></td>\n<td><input type=button "
					 +" class=\"btn_num\"=\"2\" name=\"button_number1\" value=\"1\"></td>\n<td> "
					 +" <input type=button class=\"btn_num\"name=\"button_number2\" value=\"2\">"
					 +" </td>\n<td> <input type=button class=\"btn_num\" name=\"button_number3\" "
					 +" value=\"3\"></td>\n<td> <input type=button class=\"btn_num\" "
					 +" name=\"button_number4\" value=\"4\"></td>\n<td> "
					 +" <input type=button class=\"btn_num\" name=\"button_number5\" value=\"5\">"
					 +" </td>\n<td> <input type=button class=\"btn_num\" name=\"button_number6\" "
					 +" value=\"6\"></td>\n<td> <input type=button class=\"btn_num\" "
					 +" name=\"button_number7\" value=\"7\"></td>\n<td> <input type=button" 
					 +" class=\"btn_num\" name=\"button_number8\" value=\"8\"></td>\n<td> <input "
					 +" type=button class=\"btn_num\" name=\"button_number9\" value=\"9\"></td>\n"
					 +" <td> <input class=\"btn_num\"  name=\"button_number0\" type=button "
					 +" value=\"0\"></td>\n<td> <input type=button value=\"-\"></td>\n<td>"
					 +" <input type=button value=\"=\"></td>\n<td> <input type=button "
					 +" value=\"\\\"></td>\n<td>"
					 +" <input  type=button value=\" 退格 \" name=\"btnBackSpace\" "
					 +" style=\"width:100px;height:30px;BORDER-RIGHT:1px none;FONT-SIZE: 14px\"> "
					 +"</td>\n</tr>\n<tr align=\"left\" "
					 +" valign=\"middle\"> \n<td> <input type=button name=\"button_q\" "
					 +" value=\"q\"></td>\n<td> <input type=button name=\"button_w\" "
					 +" value=\"w\"></td>\n<td> <input type=button name=\"button_e\" "
					 +" value=\"e\"></td>\n<td> <input type=button name=\"button_r\" "
					 +" value=\"r\"></td>\n<td> <input type=button name=\"button_t\" "
					 +" value=\"t\"></td>\n<td> <input type=button name=\"button_y\" "
					 +" value=\"y\"></td>\n<td> <input type=button name=\"button_u\" "
					 +" value=\"u\"></td>\n<td> <input type=button name=\"button_i\" "
					 +" value=\"i\"></td>\n<td> <input type=button name=\"button_o\" "
					 +" value=\"o\"></td>\n<td> <input name=\"button_p\" type=button "
					 +" value=\"p\"></td>\n<td> <Input name=\"button9\" type=button " 
					 +" value=\"{\"></td>\n<td> <input type=button value=\"}\"></td>\n"
					 +" <td> <input type=button value=\"[\"></td>\n<td> <input type=button"
					 +" value=\"]\"></td>\n<td><input name=\"btn_changeCase\" type=button "
					 +" value=\"切换大/小写\" style=\"width:100px;height:30px;BORDER-RIGHT:1px none;font-size:15px\">"
					 +" </td>\n</tr>\n<tr align=\"left\" valign=\"middle\"> \n<td> "
					 +" <input type=button name=\"button_a\" value=\"a\"></td>"
					 +" \n<td> <input type=button name=\"button_s\" value=\"s\"></td>\n"
					 +" <td> <input type=button name=\"button_d\" value=\"d\"></td>\n" 
					 +" <td> <input type=button  name=\"button_f\"  value=\"f\"></td>\n"
					 +" <td> <input type=button name=\"button_g\" value=\"g\"></td>\n<td>"
					 +" <input type=button name=\"button_h\"  value=\"h\"></td>\n<td> "
					 +" <input type=button name=\"button_j\" value=\"j\"></td>\n<td> "
					 +" <input name=\"button_k\" type=button value=\"k\"></td>\n<td> "
					 +" <input name=\"button_l\" type=button value=\"l\"></td>\n<td> "
					 +" <input name=\"button5\" type=button value=\":\"></td>\n<td> "
					 +" <input name=\"button7\" type=button value=\"&quot;\"></td>\n"
					 +" <td> <input type=button value=\";\"></td>\n<td> "
					 +" <input type=button value=\"'\"></td>\n<td rowspan=\"2\" colspan=\"2\">"
					 +" <input name=\"btn_keyBoardOK\" type=button bgtype=\"1\" "
					 +" value=\"   确定   \" style=\"BORDER:3px solid blue;width:130px;height:60px;FONT-SIZE: 23px;\">"
					 +" </td>\n</tr>\n<tr align=\"left\" valign=\"middle\"> \n<td>"
					 +" <input name=\"button_z\" type=button value=\"z\"></td>\n<td>"
					 +" <input type=button name=\"button_x\" value=\"x\"></td>\n<td> "
					 +" <input name=\"button_c\" type=button value=\"c\"></td>\n<td> "
					 +" <input type=button name=\"button_v\" value=\"v\"></td>\n<td> "
					 +" <input type=button name=\"button_b\" value=\"b\"></td>\n<td> "
					 +" <input type=button name=\"button_n\" value=\"n\"></td>\n<td> "
					 +" <input type=button name=\"button_m\"  value=\"m\"></td>\n<td> "
					 +" <input type=button value=\"&lt;\"></td>\n<td> <input type=button" 
					 +" value=\"&gt;\"></td>\n<td> <input type=button value=\"?\"></td>\n<td>"
					 +" <input type=button value=\",\"></td>\n <td> <input type=button value=\".\">"
					 +" </td>\n <td> <input type=button value=\"/\"></td>\n</tr>\n</table></div></td>"
					 +" </FORM></tr></table></DIV>";
				}
			}
			else
			{
				return;
			}
		}
		else
		{
			if($("#softkeyboardTrade").length==0)
			{    
				if(IS_INSTALL_CONTROL){////ie浏览器(有切换安全控件按钮)
					html="<DIV align=center id='softkeyboardTrade' name='softkeyboardTrade' "
						 +" style='position:absolute; left:0px; top:0px; width:400px; z-index:65535;display:none'>"
						 +" <table id='CalcTable' width='' border='0' align='center' style='border:1px solid #B5ADF1'" 
						 +" cellpadding='0' cellspacing='0' bgcolor=''><FORM id=CalcTrade " 
						 +" name=CalcTrade action='' method=post autocomplete='off'><tr><td" 
						 +" style='cursor: default;height:30px;padding-top: 3px;background-color:#f6f6f6;' "
						 +" align='right' valign='middle' bgcolor='' "
						 +" >&nbsp<font" 
						 +" style='font-weight:bold; font-size:15px; color:black'>"
						 +" 新疆农信&nbsp;&nbsp;密码输入器</font>&nbsp&nbsp&nbsp&nbsp"
						 +" <INPUT name='useKey' "
						 +" style='width:100px;height:25px; font-size:14px;BORDER: #e6e6e6 1px solid;CURSOR: pointer; COLOR: black;  FONT-SIZE: 14px;' "
						 +" type=button value='切换到键盘' bgtype='1' > "
						 +"  </td></tr>"
						 +"<tr align='center' valign='middle'>"
						 +"<td align='center' bgcolor='#FFFFFF'><div style='background-color:#ffffff;'><table align='center' width='100%' "
						 +" border='0' cellspacing='1' cellpadding='0'>\n"
						 +"<tr align='left' valign='middle'> \n"
						 +"<td><input type=button class='btn_num' name='button_number1'  value='1' ></td>\n"
						 +"<td><input type=button class='btn_num' name='button_number2'  value='2' ></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number3'  value='3' ></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number4'  value='4'></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number5'  value='5'></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number6'  value='6'></td>\n"
						 +"<td><input type=button class='btn_num' name='button_number7'  value='7'></td>\n "
						 +"<td colspan='1' rowspan='1'>"
						 +(IS_INSTALL_CONTROL?"<INPUT name='usePwdControl' "
						 +" style='width:100px;height:28px; font-size:13px;BORDER: #e6e6e6 1px solid;CURSOR: pointer; COLOR: black; border:#e6e6e6 1px solid ;' "
						 +" type=button value='切换到安全控件' bgtype='1' "
						 +" >":"")
						 +"\n</td>"
						 +"\n</tr>\n"
						 +"<tr align='left' valign='middle'> \n"
						 +"<td><input type=button class='btn_num' name='button_number8'  value='8'></td>\n"
						 +"<td><input type=button class='btn_num' name='button_number9'  value='9'></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number0'  value='0'></td>\n "
						 +"<td rowspan='1' colspan='4'>"
						 +" <input name='btn_keyBoardOK' type=button bgtype='1' value='   确定   ' style='BORDER:3px solid blue;width:112px;height:29px;FONT-SIZE: 18px;'> "
						 +" </td>\n"
						 +" \n<td>"
						 +"<input type=button value=' 退格 '  name='btnBackSpace'  style='width:100px;height:28px;BORDER-RIGHT:1px none;FONT-SIZE: 15px;border-bottom:0 none;'> "
						 +" \n</td>"
						 +"</tr>"
						 +" \n</table></div></td>"
						 +" </FORM></tr></table></DIV>";
					
				}else{//非ie浏览器(无切换安全控件按钮)
					html="<DIV align=center id='softkeyboardTrade' name='softkeyboardTrade' "
						 +" style='position:absolute; left:0px; top:0px; width:400px; z-index:65535;display:none'>"
						 +" <table id='CalcTable' width='' border='0' align='center' style='border:1px solid #B5ADF1'" 
						 +" cellpadding='0' cellspacing='0' bgcolor=''><FORM id=CalcTrade " 
						 +" name=CalcTrade action='' method=post autocomplete='off'><tr><td" 
						 +" style='cursor: default;height:30px;padding-top: 3px;background-color:#f6f6f6;' "
						 +" align='center' valign='middle' bgcolor=''> "
						 +" &nbsp<font" 
						 +" style='font-weight:bold; font-size:15px; color:black'>"
						 +" 新疆农信&nbsp;&nbsp;密码输入器</font>"
						 +" &nbsp&nbsp;&nbsp;&nbsp&nbsp;&nbsp;"
						 +"  </td></tr>"
						 +"<tr align='center' valign='middle'>"
						 +"<td align='center' bgcolor='#FFFFFF'><div style='background-color:#ffffff;'><table align='center' width='%' "
						 +" border='0' cellspacing='1' cellpadding='0'>\n"
						 +"<tr align='left' valign='middle'> \n"
						 +"<td><input type=button class='btn_num' name='button_number1'  value='1' ></td>\n"
						 +"<td><input type=button class='btn_num' name='button_number2'  value='2' ></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number3'  value='3' ></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number4'  value='4'></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number5'  value='5'></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number6'  value='6'></td>\n"
						 +"<td><input type=button class='btn_num' name='button_number7'   value='7'></td>\n "
						 +"<td >"
						 +"<INPUT name='useKey'  "
						 +" style='width:100px;height:28px; font-size:14px;BORDER: #e6e6e6 1px solid;CURSOR: pointer; COLOR: black;  FONT-SIZE: 14px;' "
						 +" type=button value='切换到键盘' bgtype='1'> "
						 +"\n</td>"
						 +"\n</tr>\n"
						 +"<tr align='left' valign='middle'> \n"
						 +"<td><input type=button class='btn_num' name='button_number8'  value='8'></td>\n"
						 +"<td><input type=button class='btn_num' name='button_number9'  value='9'></td>\n "
						 +"<td><input type=button class='btn_num' name='button_number0'  value='0'></td>\n "
						 +"<td rowspan='1' colspan='4'>"
						 +" <input name='btn_keyBoardOK' type=button bgtype='1' value='   确定   ' style='BORDER:3px solid blue;width:112px;height:29px;FONT-SIZE: 18px;'> "
						 +" </td>\n"
						 +" \n<td>"
						 +"<input type=button value=' 退格 '  name='btnBackSpace'  style='width:100px;height:28px;BORDER-RIGHT:1px none;FONT-SIZE: 14px;border-bottom:0 none;'> "
						 +" \n</td>"
						 +"</tr>"
						 +" \n</table></div></td>"
						 +" </FORM></tr></table></DIV>";
					
				}
				
			}
			else
			{
				return;
			}
				
		}
		$(document.body).append(html);
		var keyboard="#softkeyboard";
		if(this.options.passwordType==1)
		{
			 var keyboard="#softkeyboardTrade";	 
		}
		$(keyboard).find("input").each(function(){
			
			if($(this).val().length==1)
			{
				$(this).attr("title",$(this).val());
				//$(this).css("text-align","center");
				//$(this).css("BORDER-right","1px solid #dfe5ee");
				$(this).css("BORDER","1px solid #dfe5ee");
				$(this).css("FONT-SIZE","18px");
				$(this).css("background-color","#f7f9fb");
				$(this).css("CURSOR","pointer");
				$(this).css("width","28px");
				$(this).css("height","28px");
				$(this).css("line-height","18px");
				//$(this).css("border-bottom","0 none");
				$(this).css("color","#666");
				$(this).css("padding","0");
				
				$(this).bind("click",function()
				{
					var tmp=$("#input_"+$(keyboard).data("rad"));
					var len=tmp.val().length;
					if(keyboardGroup[$(keyboard).data("rad")].options.passwordType==0)
					{
						maxLength=20;
					}
					else
					{
						maxLength=6;
					}
					if(len<maxLength)
					{
						tmp.val(tmp.val()+$(this).val());
					}
					
				});
			}
			else if($(this).attr("name")=="usePwdControl")
			{
				$(this).bind("click",function()
				{
					keyboardGroup[$(keyboard).data("rad")].showControl();
					$(keyboard).hide();
					$("#fra_softKey").hide();
				})
			}
			else if($(this).attr("name")=="useKey")
			{
				
				$(this).bind("click",function()
				{
					keyboardGroup[$(keyboard).data("rad")].showInput();
					$(keyboard).hide();
					$("#fra_softKey").hide();
				})
			}
			else if($(this).attr("name")=="btnBackSpace")
			{
				$(this).bind("click",function()
				{
					var tmp=$("#input_"+$(keyboard).data("rad"));
					var len=tmp.val().length;
					if(len>0)
					{
						tmp.val(tmp.val().substr(0,len-1));
					}
				})
				
				 
			}
			else if($(this).attr("name")=="btn_changeCase")
			{
				
				$(this).bind("click",function()
				{
					$(keyboard).find("input").each(function(){
						var tmp=$(this).val();
						if(tmp>="a" && tmp<="z")
						{
							$(this).val(tmp.toUpperCase());
						}
						else if(tmp>="A" && tmp<="Z")
						{
							$(this).val(tmp.toLowerCase());
						}
					});
					if($(keyboard).data("case")=="0")//小写
					{
						$(keyboard).data("case","1");
					}
					else
					{
						$(keyboard).data("case","0");
					}
				}) 
				 
			}
			else if($(this).attr("name")=="btn_keyBoardOK")
			{
				
				$(this).bind("click",function()
				{
					$(keyboard).hide();
					$("#fra_softKey").hide();
					$("#input_"+$(keyboard).data("rad")).attr("readonly",false);
				})
				 
			}	
		});
		
		 
	}
		 
 	this.init();	 
	 
 }
 
 </script>

 
<link href="/perbank/resource/plugins/artDialog/skins/aero.css?version=1,0,0,2" rel="stylesheet" type="text/css">


 



<script type="text/javascript">


/*
 * hdj 全面更改 ，适应自己有的usbkey
 */
 var keyProviders= [];
 
 var obj = {};//2
 obj.keyModel="2";
 
 try
 {  
	var classId=getUsbkeyClassId(obj.keyModel); 
// 	if(classId[0]=="JSKeyCtrl")
// 	{
// 		try
// 		{
// 			var tmp1= new ActiveXObject("Softbank.Feitian12");
// 			obj.driver= document.getElementById("JSKeyCtrl");
// 			obj.classId=classId[0];
// 		}
// 		catch(e)
// 		{
// 			try
// 			{
// 				var tmp1= new ActiveXObject("FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1");
// 				obj.driver= document.getElementById("JSKeyCtrl2");	
// 				obj.classId=classId[1];
// 			}
// 			catch(e1)
// 			{
				
// 			}
// 		}
		 
// 	}
// 	else if(classId[0]=="DZSHFTKeyCtrl")
// 	{
	
// 		try
// 		{
// 			var tmp1= new ActiveXObject("Softbank.Feitian26");
// 			obj.driver= document.getElementById("DZSHFTKeyCtrl");
// 			obj.classId=classId[0];
// 		}
// 		catch(e)
// 		{
// 			try
// 			{
// 				//var tmp1= new ActiveXObject("FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1");
// 				obj.driver= document.getElementById("DZSHFTKeyCtrl2");	
// 				obj.classId=classId[1];
// 			}
// 			catch(e1)
// 			{
				
// 			}
// 		}
// 	}
// 	else
// 	{
		try
		{
			obj.driver= new ActiveXObject(classId[0]);
			obj.classId=classId[0];	
		}
		catch(e1)
		{
			try
			{
				obj.driver= new ActiveXObject(classId[1]);
				obj.classId=classId[1];
			}
			catch(e2)
			{
				
			}
		}
			
// 	}
	 
	
		 
 }
 catch(e)
 {
	 
 }
 keyProviders[obj.keyModel]=obj;
 
 
 var obj = {};//3
 obj.keyModel="3";
 
 try
 {  
	var classId=getUsbkeyClassId(obj.keyModel); 
// 	if(classId[0]=="JSKeyCtrl")
// 	{
// 		try
// 		{
// 			var tmp1= new ActiveXObject("Softbank.Feitian12");
// 			obj.driver= document.getElementById("JSKeyCtrl");
// 			obj.classId=classId[0];
// 		}
// 		catch(e)
// 		{
// 			try
// 			{
// 				var tmp1= new ActiveXObject("FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1");
// 				obj.driver= document.getElementById("JSKeyCtrl2");	
// 				obj.classId=classId[1];
// 			}
// 			catch(e1)
// 			{
				
// 			}
// 		}
		 
// 	}
// 	else if(classId[0]=="DZSHFTKeyCtrl")
// 	{
	
// 		try
// 		{
// 			var tmp1= new ActiveXObject("Softbank.Feitian26");
// 			obj.driver= document.getElementById("DZSHFTKeyCtrl");
// 			obj.classId=classId[0];
// 		}
// 		catch(e)
// 		{
// 			try
// 			{
// 				//var tmp1= new ActiveXObject("FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1");
// 				obj.driver= document.getElementById("DZSHFTKeyCtrl2");	
// 				obj.classId=classId[1];
// 			}
// 			catch(e1)
// 			{
				
// 			}
// 		}
// 	}
// 	else
// 	{
		try
		{
			obj.driver= new ActiveXObject(classId[0]);
			obj.classId=classId[0];	
		}
		catch(e1)
		{
			try
			{
				obj.driver= new ActiveXObject(classId[1]);
				obj.classId=classId[1];
			}
			catch(e2)
			{
				
			}
		}
			
// 	}
	 
	
		 
 }
 catch(e)
 {
	 
 }
 keyProviders[obj.keyModel]=obj;
 
 
 var obj = {};//4
 obj.keyModel="4";
 
 try
 {  
	var classId=getUsbkeyClassId(obj.keyModel); 
// 	if(classId[0]=="JSKeyCtrl")
// 	{
// 		try
// 		{
// 			var tmp1= new ActiveXObject("Softbank.Feitian12");
// 			obj.driver= document.getElementById("JSKeyCtrl");
// 			obj.classId=classId[0];
// 		}
// 		catch(e)
// 		{
// 			try
// 			{
// 				var tmp1= new ActiveXObject("FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1");
// 				obj.driver= document.getElementById("JSKeyCtrl2");	
// 				obj.classId=classId[1];
// 			}
// 			catch(e1)
// 			{
				
// 			}
// 		}
		 
// 	}
// 	else if(classId[0]=="DZSHFTKeyCtrl")
// 	{
	
// 		try
// 		{
// 			var tmp1= new ActiveXObject("Softbank.Feitian26");
// 			obj.driver= document.getElementById("DZSHFTKeyCtrl");
// 			obj.classId=classId[0];
// 		}
// 		catch(e)
// 		{
// 			try
// 			{
// 				//var tmp1= new ActiveXObject("FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1");
// 				obj.driver= document.getElementById("DZSHFTKeyCtrl2");	
// 				obj.classId=classId[1];
// 			}
// 			catch(e1)
// 			{
				
// 			}
// 		}
// 	}
// 	else
// 	{
		try
		{
			obj.driver= new ActiveXObject(classId[0]);
			obj.classId=classId[0];	
		}
		catch(e1)
		{
			try
			{
				obj.driver= new ActiveXObject(classId[1]);
				obj.classId=classId[1];
			}
			catch(e2)
			{
				
			}
		}
			
// 	}
	 
	
		 
 }
 catch(e)
 {
	 
 }
 keyProviders[obj.keyModel]=obj;
 
 
 var obj = {};//5
 obj.keyModel="5";
 
 try
 {  
	var classId=getUsbkeyClassId(obj.keyModel); 
// 	if(classId[0]=="JSKeyCtrl")
// 	{
// 		try
// 		{
// 			var tmp1= new ActiveXObject("Softbank.Feitian12");
// 			obj.driver= document.getElementById("JSKeyCtrl");
// 			obj.classId=classId[0];
// 		}
// 		catch(e)
// 		{
// 			try
// 			{
// 				var tmp1= new ActiveXObject("FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1");
// 				obj.driver= document.getElementById("JSKeyCtrl2");	
// 				obj.classId=classId[1];
// 			}
// 			catch(e1)
// 			{
				
// 			}
// 		}
		 
// 	}
// 	else if(classId[0]=="DZSHFTKeyCtrl")
// 	{
	
// 		try
// 		{
// 			var tmp1= new ActiveXObject("Softbank.Feitian26");
// 			obj.driver= document.getElementById("DZSHFTKeyCtrl");
// 			obj.classId=classId[0];
// 		}
// 		catch(e)
// 		{
// 			try
// 			{
// 				//var tmp1= new ActiveXObject("FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1");
// 				obj.driver= document.getElementById("DZSHFTKeyCtrl2");	
// 				obj.classId=classId[1];
// 			}
// 			catch(e1)
// 			{
				
// 			}
// 		}
// 	}
// 	else
// 	{
		try
		{
			obj.driver= new ActiveXObject(classId[0]);
			obj.classId=classId[0];	
		}
		catch(e1)
		{
			try
			{
				obj.driver= new ActiveXObject(classId[1]);
				obj.classId=classId[1];
			}
			catch(e2)
			{
				
			}
		}
			
// 	}
	 
	
		 
 }
 catch(e)
 {
	 
 }
 keyProviders[obj.keyModel]=obj;
 
 
 for(var i=0;i<keyProviders.length;i++)
 {
	 if(keyProviders[i] && keyProviders[i].driver)
	 {
		 obj=keyProviders[i];
		 obj.getUsbkeySN=function()
		 {
			 	if(this.keyModel=="2"||this.keyModel=="6")//haitai
				{
					return this.driver.GetMediaID();
				}
				else if(this.keyModel=="3"||this.keyModel=="7")//woqi
				{
					 
					return this.driver.GetMediaID;
				}
				else if(this.keyModel=="4"||this.keyModel=="8")//hengyin
				{
					
					return this.driver.GetSN();
				}
				else if(this.keyModel=="5"||this.keyModel=="9")//longxin
				{
					
					return this.driver.LCOMGetKeySerialForKey();
				}
// 				else if(this.keyModel=="6")
// 				{
// 					//this.driver= new ActiveXObject(this.classId);
// 					var listNum=this.listNum();
// 					return this.driver.GetUsbkeySN;
// 				}
// 				else if(this.keyModel=="8"||this.keyModel=="26")
// 				{
// 					var listNum=this.listNum();
// 					return this.driver.GetUsbkeySN();
// 				}
// 				else if(this.keyModel=="9")
// 				{
// 					var listNum=this.listNum();
// 					return this.driver.GetUsbkeySN;
// 				}
// 				else if(this.keyModel=="10")
// 				{
// 					var listNum=this.listNum();
// 					return this.driver.GetUsbkeySN();
// 				}
// 				else if(this.keyModel=="11")
// 				{
// 					var listNum=this.listNum();
// 					return this.driver.GetUsbkeySN();
// 				}
// 				else if(this.keyModel=="12")
// 				{
// 					this.driver.GetUSBKeyState();
// 					return this.driver.GetUsbkeySN();
// 				}
// 				else if(this.keyModel=="13")
// 				{
// 					var listNum=this.listNum();
// 					return this.driver.GetUsbkeySN;
// 				}
// 				else if(this.keyModel=="14")
// 				{
// 					var keyno14 = this.driver.GetUsbkeySN();
// 					
// 					return keyno14;
// 				}
// 				else if(this.keyModel=="15")
// 				{
// 					this.driver.GetUSBKeyState();
// 					return this.driver.GetUsbkeySN();
// 				}
// 				else if(this.keyModel=="16")
// 				{
// 					this.driver.GetUSBKeyState();
// 					return this.driver.GetUsbkeySN();
// 				}
// 				else if(this.keyModel=="22")
// 				{
// 					this.driver.GetUSBKeyState();
// 					return this.driver.GetUsbkeySN();
// 				}
// 				else if(this.keyModel=="23")
// 				{
// 					this.driver.GetUSBKeyState();
// 					return this.driver.GetUsbkeySN();
// 				}
// 				else if(this.keyModel=="25")
// 				{
// 					//this.driver.GetUSBKeyState();
// 					return this.driver.GetMediaID;
// 				}
		 };
		 obj.listNum=function()
		 {
			 	if(this.keyModel=="2"||this.keyModel=="6")
				{
					return this.driver.GetDeviceCount();
				}
				else if(this.keyModel=="3"||this.keyModel=="7")
				{
					 
					return this.driver.CheckUSBKeyExist();
				}
				else if(this.keyModel=="4"||this.keyModel=="8")
				{
					
					return this.driver.CheckToken();
				}
				else if(this.keyModel=="5"||this.keyModel=="9")
				{
					
					return this.driver.GetDeviceCount();
				}
// 				else if(this.keyModel=="6")
// 				{
					
// 					return this.driver.ListUsbkeyNumber;
// 				}
// 				else if(this.keyModel=="8"||this.keyModel=="26")
// 				{
					
// 					return this.driver.ListUsbkeyNumber();
// 				}
// 				else if(this.keyModel=="9")
// 				{
					
// 					return this.driver.ListUsbkeyNumber;
// 				}
// 				else if(this.keyModel=="10")
// 				{
					
// 					return this.driver.ListUsbkeyNumber();
// 				}
// 				else if(this.keyModel=="11")
// 				{
					
// 					return this.driver.ListUsbkeyNumber();
// 				}
// 				else if(this.keyModel=="12")
// 				{
// 					var tmp=this.driver.GetUSBKeyState();
// 					if(tmp==3)
// 					{
// 						return "1";
// 					}
// 					else if(tmp==4)
// 					{
// 						return "2";
// 					}
// 					else
// 					{
// 						return "0";
// 					}
					 
// 				}
// 				else if(this.keyModel=="13")
// 				{
					
// 					return this.driver.ListUsbkeyNumber;
// 				}
// 				else if(this.keyModel=="14")
// 				{
// 					return this.driver.ListUsbkeyNumber();
	 
// 				}
// 				else if(this.keyModel=="15")
// 				{
// 					var tmp=this.driver.GetUSBKeyState();
// 					if(tmp==3)
// 					{
// 						return "1";
// 					}
// 					else if(tmp==4)
// 					{
// 						return "2";
// 					}
// 					else
// 					{
// 						return "0";
// 					}
// 				}
// 				else if(this.keyModel=="16"||this.keyModel=="22" ||this.keyModel=="23")
// 				{
// 					var tmp=this.driver.GetUSBKeyState();
// 					if(tmp==3)
// 					{
// 						return "1";
// 					}
// 					else if(tmp==4)
// 					{
// 						return "2";
// 					}
// 					else
// 					{
// 						return "0";
// 					}
// 				}
// 				else if(this.keyModel=="25")
// 				{
// 					return this.driver.CheckUSBKeyExist();
	 
// 				}
		 };
		 obj.genUsbkeyPKCCS10=function (refNo)
		 {
				var ret;
				 
	 	 
				 
			    if(this.keyModel==0)
			    {
					/* jdUsb.providerName = "GLSH Virtual CSP";
					jdUsb.providerType = 1;
					jdUsb.HashAlgorithm = "MD5";
				//	cn="CN=" & theForm.refNo.value;
					cn = "CN="+refNo;
					jdUsb.KeySpec = 1;
					jdUsb.GenKeyFlags = 3;
					pkcs10req=jdUsb.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
					if(pkcs10req=="")
			    	{
			    		alert("生成公私钥对失败");
			    		return false;
			    	}
					return pkcs10req;	    	 */
			    }
			    if(this.keyModel==1)
			    {
			    	/* initProv(UniContrl.enumProviders(1));
			    	return createPubKey(1024); */
//		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
//		 			EnrollNew.providerType = 1;
//		 			EnrollNew.HashAlgorithm = "MD5";
//		 		//	cn="CN=" & theForm.refNo.value;
//		 			cn = "CN="+refNo;
//		 			EnrollNew.KeySpec = 1;
//		 			EnrollNew.GenKeyFlags = 3;
//		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
//		 			return pkcs10req;	    	
			    }
			    if(this.keyModel==2||this.keyModel=="6")
			    {
			    
			    	ret=this.createRequest("HaiTai CSP FOR XJNX",refNo);
			    	if(ret=="")
			    	{
			    		alert("生成公私钥对失败");
			    		return false;
			    	}
			    	//return CreateRequest("HaiTai Cryptographic Service Provider",refNo);
			    	return ret;
//		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
//		 			EnrollNew.providerType = 1;
//		 			EnrollNew.HashAlgorithm = "MD5";
//		 		//	cn="CN=" & theForm.refNo.value;
//		 			cn = "CN="+refNo;
//		 			EnrollNew.KeySpec = 1;
//		 			EnrollNew.GenKeyFlags = 3;
//		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
//		 			return pkcs10req;	    	
			    }
			    if(this.keyModel==3||this.keyModel=="7")
			    {
			    	
			    	ret= this.createRequest("NXYCSP_88_WQ",refNo);
			    	if(ret=="")
			    	{
			    		alert("生成公私钥对失败");
			    		return false;
			    	}
			    	return ret;
//		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
//		 			EnrollNew.providerType = 1;
//		 			EnrollNew.HashAlgorithm = "MD5";
//		 		//	cn="CN=" & theForm.refNo.value;
//		 			cn = "CN="+refNo;
//		 			EnrollNew.KeySpec = 1;
//		 			EnrollNew.GenKeyFlags = 3;
//		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
//		 			return pkcs10req;	    	
			    }
			    if(this.keyModel==4||this.keyModel=="8")
			    {
			     	ret= this.createRequest("Cashway Safe XJRCC CSP V1.0",refNo);
			    	if(ret=="")
			    	{
			    		alert("生成公私钥对失败");
			    		return false;
			    	}
			    	return ret;
			    //	return CreateRequest("Cashway Safe XJRCC CSP V1.0",refNo);
//		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
//		 			EnrollNew.providerType = 1;
//		 			EnrollNew.HashAlgorithm = "MD5";
//		 		//	cn="CN=" & theForm.refNo.value;
//		 			cn = "CN="+refNo;
//		 			EnrollNew.KeySpec = 1;
//		 			EnrollNew.GenKeyFlags = 3;
//		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
//		 			return pkcs10req;	    	
			    }
			    if(this.keyModel==5||this.keyModel=="9")
			    {
			    	ret= this.createRequest("ChinaCpu Xjnx CSP v1.0",refNo);
			    	if(ret=="")
			    	{
			    		alert("生成公私钥对失败");
			    		return false;
			    	}
			    	return ret;
			    	
			    	//return CreateRequest("ChinaCpu USB Key CSP v1.0",refNo);
//		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
//		 			EnrollNew.providerType = 1;
//		 			EnrollNew.HashAlgorithm = "MD5";
//		 		//	cn="CN=" & theForm.refNo.value;
//		 			cn = "CN="+refNo;
//		 			EnrollNew.KeySpec = 1;
//		 			EnrollNew.GenKeyFlags = 3;
//		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
//		 			return pkcs10req;	    	
			    }
// 			    if(this.keyModel==6)
// 			    {
// 			    	 
// 			    	 
// 			    	 ret= this.createRequest("EnterSafe ePass2000Auto CSP v1.0",refNo);
// 			    	 
			    	
			    	
// 			    	if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
// 			    	}
// 			    	return ret;
			    	
// 			    	//return CreateRequest("ChinaCpu USB Key CSP v1.0",refNo);
// //		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
// //		 			EnrollNew.providerType = 1;
// //		 			EnrollNew.HashAlgorithm = "MD5";
// //		 		//	cn="CN=" & theForm.refNo.value;
// //		 			cn = "CN="+refNo;
// //		 			EnrollNew.KeySpec = 1;
// //		 			EnrollNew.GenKeyFlags = 3;
// //		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
// //		 			return pkcs10req;	    	
// 			    }
// 			    if(this.keyModel==8)
// 			    {
// 			    	/* try{
// 			    		var Csps = new ActiveXObject("X509Enrollment.CCspInformations.1")
// 			    		Csps.AddAvailableCsps();
// 			    	}catch(e){
// 			    		alert("加载csp name失败");
// 			    	}
					
// 			    	for(var i=0 ;i<Csps.Count;i++)
// 			    	{
// 			       		if(Csps.ItemByIndex(i).Name=="EnterSafe InterPass3000 CSP For IBOC V1.0")
// 			       		{
// 			       			cspName=Csps.ItemByIndex(i).Name;
// 			       			break;
// 			       		}
// 			       	}
// 			       	if(cspName=="")
// 			      		{
// 			      			alert("飞天CSP未安装!");
// 			      			return false;
// 			      		}
// 			       	 */
// 			       	 //EnterSafe InterPass3000 CSP v1.0
// 			       	 //InterPass3000 CSP v1.0
// 			       	 //EnterSafe InterPass3000 CSP For IBOC V1.0
// 			       	var ret ="";
// 			       //	var ret= CreateRequest("EnterSafe InterPass3000 CSP For IBOC V1.0",refNo);
// 			       	
// 			    	
// 			    		ret= this.createRequest("InterPass3000 CSP v1.0",refNo);
// 			    	
// 			    	 if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
// 			    	}
// 			    	return ret;
			    	
// 			    	//return CreateRequest("ChinaCpu USB Key CSP v1.0",refNo);
// //		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
// //		 			EnrollNew.providerType = 1;
// //		 			EnrollNew.HashAlgorithm = "MD5";
// //		 		//	cn="CN=" & theForm.refNo.value;
// //		 			cn = "CN="+refNo;
// //		 			EnrollNew.KeySpec = 1;
// //		 			EnrollNew.GenKeyFlags = 3;
// //		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
// //		 			return pkcs10req;	    	
// 			    }
// 			    if(this.keyModel==26)
// 			    {
// 			    	/* try{
// 			    		var Csps = new ActiveXObject("X509Enrollment.CCspInformations.1")
// 			    		Csps.AddAvailableCsps();
// 			    	}catch(e){
// 			    		alert("加载csp name失败");
// 			    	}
					
// 			    	for(var i=0 ;i<Csps.Count;i++)
// 			    	{
// 			       		if(Csps.ItemByIndex(i).Name=="EnterSafe InterPass3000 CSP For IBOC V1.0")
// 			       		{
// 			       			cspName=Csps.ItemByIndex(i).Name;
// 			       			break;
// 			       		}
// 			       	}
// 			       	if(cspName=="")
// 			      		{
// 			      			alert("飞天CSP未安装!");
// 			      			return false;
// 			      		}
// 			       	 */
// 			       	 //EnterSafe InterPass3000 CSP v1.0
// 			       	 //InterPass3000 CSP v1.0
// 			       	 //EnterSafe InterPass3000 CSP For IBOC V1.0
// 			       	var ret ="";
// 			       //	var ret= CreateRequest("EnterSafe InterPass3000 CSP For IBOC V1.0",refNo);
			       	 
// 			       		ret= this.createRequest("EnterSafe interPass3000 CSP For DZCCB V1.0",refNo);
			    	 
// 			    	 if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
// 			    	}
// 			    	return ret;
			    	
// 			    	//return CreateRequest("ChinaCpu USB Key CSP v1.0",refNo);
// //		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
// //		 			EnrollNew.providerType = 1;
// //		 			EnrollNew.HashAlgorithm = "MD5";
// //		 		//	cn="CN=" & theForm.refNo.value;
// //		 			cn = "CN="+refNo;
// //		 			EnrollNew.KeySpec = 1;
// //		 			EnrollNew.GenKeyFlags = 3;
// //		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
// //		 			return pkcs10req;	    	
// 			    }
// 			    if(this.keyModel==9)
// 			    {
// 			    	ret= this.createRequest("CGXYYH CSP V2.0",refNo);
// 			    	if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
// 			    	}
// 			    	return ret;
			    	
// 			    	//return CreateRequest("ChinaCpu USB Key CSP v1.0",refNo);
// //		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
// //		 			EnrollNew.providerType = 1;
// //		 			EnrollNew.HashAlgorithm = "MD5";
// //		 		//	cn="CN=" & theForm.refNo.value;
// //		 			cn = "CN="+refNo;
// //		 			EnrollNew.KeySpec = 1;
// //		 			EnrollNew.GenKeyFlags = 3;
// //		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
// //		 			return pkcs10req;	    	
// 			    }
// 			    if(this.keyModel==10)
// 			    {
// 			    	var cspName="";
// //		 	    	for(var i=0 ;i<Csps.Count;i++)
// //		 			{
// //		 	    		if(Csps.ItemByIndex(i).Name=="InterPass2000CSP v1.0")
// //		 	    		{
// //		 	    			cspName=Csps.ItemByIndex(i).Name;
// //		 	    			break;
// //		 	    		}
// //		 	    	}
// //		 	    	if(cspName=="")
// //		     		{
// //		     			alert("飞天CSP未安装!");
// //		     			return false;
// //		     		}
// 			    	cspName="InterPass2000CSP v1.0";
// 			    	ret= this.createRequest(cspName,refNo);
// 			    	if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
			    		
// 			    	}
// 			    	return ret;
			    	
// 			    	//return CreateRequest("ChinaCpu USB Key CSP v1.0",refNo);
// //		 			EnrollNew.providerName = "HaiTai Cryptographic Service Provider";
// //		 			EnrollNew.providerType = 1;
// //		 			EnrollNew.HashAlgorithm = "MD5";
// //		 		//	cn="CN=" & theForm.refNo.value;
// //		 			cn = "CN="+refNo;
// //		 			EnrollNew.KeySpec = 1;
// //		 			EnrollNew.GenKeyFlags = 3;
// //		 			pkcs10req=EnrollNew.CreatePKCS10(cn, "1.3.6.1.5.5.7.3.2");
// //		 			return pkcs10req;	    	
// 			    }
// 			    if(this.keyModel==11)
// 			    {
// 			    	var cspName="";
// 			    	cspName="FDBANK ET P-KEY CSP V1.0";
// 			    	ret= this.createRequest(cspName,refNo);
// 			    	if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
			    		
// 			    	}
// 			    	return ret;
// 			    }
// 			    if(this.keyModel==12 ||this.keyModel==15 || this.keyModel==16 || this.keyModel==22|| this.keyModel==23)
// 			    {
// 			    	var cspName="";
// 			    	this.driver.GetUSBKeyState();
// 			    	cspName= this.driver.GetCSPName();
// 			    	if(""==cspName){
// 			    		alert("生成公私钥对失败");
// 			    		return false;
// 			    	}
// 			    	ret= this.createRequest(cspName,refNo);
// 			    	if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
			    		
// 			    	}
// 			    	return ret;
// 			    }
// 			    if(this.keyModel==13)
// 			    {
			   
// 			       	var ret ="";
// 			       //	var ret= CreateRequest("EnterSafe InterPass3000 CSP For IBOC V1.0",refNo);
// 			       	ret= this.createRequest("EnterSafe InterPass3000 CSP For IBOC V1.0",refNo);
			       
// 			    	if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
// 			    	}
// 			    	return ret;
			    	    	
// 			    }
// 			    if(this.keyModel==14)
// 			    {
			   
// 			       	var ret ="";
// 			       //	var ret= CreateRequest("EnterSafe InterPass3000 CSP For IBOC V1.0",refNo);
// 			       	ret= this.createRequest("EnterSafe ePass2000Auto CSP For BSBank v1.0",refNo);
			       
// 			    	if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
// 			    	}
// 			    	return ret;
			    	    	
// 			    }
// 			    if(this.keyModel==25)
// 			    {
			   
// 			       	var ret ="";
// 			       //	var ret= CreateRequest("EnterSafe InterPass3000 CSP For IBOC V1.0",refNo);
// 			       	ret= this.createRequest("NXYCSP_19_WQ",refNo);
			       
// 			    	if(ret=="")
// 			    	{
// 			    		alert("生成公私钥对失败");
// 			    		return false;
// 			    	}
// 			    	return ret;
			    	    	
// 			    }
			};
			obj.createRequest=function (cspName,refNo)
			{
				this.cspName=cspName;
// 				try
// 				{
// 					var enroll= new ActiveXObject ("Softbank.CertEnrollment");	
// 				}
// 				catch(e)
// 				{
					try
					{
						var enroll= new ActiveXObject ("CryptoKit.CryptoAgent.CertEnrollment.UD.X86.1");	
					}
					catch(e)
					{
						if(IsVista())
						{
							var enroll;
							var privateKey;
							var pkcs10Req;
							var objectID;
							var SubName;
							
							try{
								enroll = new ActiveXObject("X509Enrollment.CX509Enrollment");
								privateKey = new ActiveXObject("X509Enrollment.CX509PrivateKey");
								pkcs10Req = new ActiveXObject("X509Enrollment.CX509CertificateRequestPkcs10");
								objectID = new ActiveXObject("X509Enrollment.CObjectId");
								SubName = new ActiveXObject("X509Enrollment.CX500DistinguishedName");
							}catch(e){
								var message =e.message;
								alert("生产公私钥对失败，您的操作系统和浏览器设置不支持在线下载证书，请换台电脑尝试或者到我行柜面下载证书.错误信息："+message);
								return "";
							}
							
							try{	
								privateKey.ProviderName = cspName;
								privateKey.Existing = false;
								privateKey.ExportPolicy = 1 ;//'XCN_NCRYPT_ALLOW_EXPORT_FLAG=1
								privateKey.KeySpec = 2;// 'XCN_AT_SIGNATURE=2, XCN_AT_KEYEXCHANGE=1
								var cn= "CN=" + refNo;
								
								objectID.InitializeFromValue ("1.2.840.113549.2.5" );// 'MD5
								SubName.Encode( cn, 3); //'XCN_CERT_X500_NAME_STR=3
					
								pkcs10Req.InitializeFromPrivateKey( 1, privateKey, "" );// 'ContextUser=1
								pkcs10Req.HashAlgorithm = objectID;
								//pkcs10Req.Subject = SubName;
								
								enroll.InitializeFromRequest ( pkcs10Req );
								return  enroll.CreateRequest(1);// 'XCN_CRYPT_STRING_BASE64=1
							}

							catch(e)
							{
								var message =e.message;
								alert("生产公私钥对失败，您的操作系统和浏览器设置不支持在线下载证书，请换台电脑尝试或者到我行柜面下载证书.错误信息："+message);
								

								return "";
							}
						}
						else
						{
							try
							{
								try
								{
									var  Enroll = new ActiveXObject("CEnroll.CEnroll.2")	;//'EnrollNew	
									if(0 ==  Enroll.enumProviders(0,0).length) 
									{
										Enroll =  new ActiveXObject("CEnroll.CEnroll.1");
									}

								}
								catch (e)
								{
									var Enroll =  new ActiveXObject("CEnroll.CEnroll.1");
								}
								Enroll.ProviderName=cspName;
								Enroll.ProviderType=1 ;//'options(index).value
								Enroll.HashAlgorithm="MD5";//
								Enroll.KeySpec=2;//
								Enroll.GenKeyFlags=3;//
								szName = "CN=" + refNo;
								return Enroll.CreatePKCS10(szName,"1.3.6.1.5.5.7.3.2");
							}
							catch(e)
							{
								var message =e.message;
								alert("生产公私钥对失败，您的操作系统和浏览器设置不支持在线下载证书，请换台电脑尝试或者到我行柜面下载证书.错误信息："+message);
								return "";
							}
						}					
		
					}
									
// 				}
				var keyType ="RSA";
				var keyLen = 2048;
// 				
// 				
// 				var keyLen = 1024;
// 				
			 
				var userDn = "CN=certRequisition,O=CMCA CA,C=CN";
				
				//var cspName = document.getElementById("cspTypeName").value;
				
				try{
					var res1 =enroll.CFCA_SetCSPInfo(keyLen, cspName);
					if (!res1) {
						alert("set cspName fail.");
						//alert(errors_genRequest+CryptoAgent.GetLastErrorDesc());
						return false;
				    }
					enroll.CFCA_SetKeyAlgorithm(keyType);
					try{
						var p10Req = enroll.CFCA_PKCS10CertRequisition(userDn, 1, 1);
						this.containerName=enroll.CFCA_GetContainer();
						return p10Req;
						//document.forms[0].sm2ContainerName.value = CFCAEnroll.CFCA_GetContainer();
			 	    	//document.forms[0].sm2P10.value = p10Req;
					}catch(e){
						try{
							// 使用MD5算法再产生一次
							var p10Req = enroll.CFCA_PKCS10CertRequisitionwithMD5(userDn, 1, 1);
							this.containerName=enroll.CFCA_GetContainer();
							return p10Req;
							//document.forms[0].sm2ContainerName.value = CFCAEnroll.CFCA_GetContainer();
			 	    		//document.forms[0].sm2P10.value = p10Req;
			 	    		
						}catch(ex){
							alert(ex.message);
							return false;
						}
					}
				}catch(ex){
					alert(ex.message);
					//popupPrompts(errors_genRequest+ex.message);
					return false;
				}   				

 			};
			obj.installCert=function (cert)
			{
				try{
// 					try
// 					{
// 						var enroll= new ActiveXObject ("Softbank.CertEnrollment");	
// 					}
// 					catch(e)
// 					{
						try
						{
							var enroll= new ActiveXObject ("CryptoKit.CryptoAgent.CertEnrollment.UD.X86");	
							
						}
						catch(e1)
						{
							if(IsVista())
							{
								try
								   {
									   var Enroll = new ActiveXObject("X509Enrollment.CX509Enrollment")	;
									   certResponse = "-----BEGIN CERTIFICATE-----\n\r"+ cert + "\n\r-----END CERTIFICATE-----\n\r"  ;
									   Enroll.Initialize(1);
									   Enroll.InstallResponse(4, certResponse, 6, "");   
									   alert("证书下载成功！");
									   return true;
								   }
								   catch(e)
								   {
									   alert("证书下载失败"+e.message);
									   return false;
								   }
							}
							else
							{
								try
								{
									var Enroll = new ActiveXObject("CEnroll.CEnroll.2")	;
									   if(Enroll.enumProviders(0,0).length==0)
									   {
										   Enroll = new ActiveXObject("CEnroll.CEnroll.1")	;
									   }
									   Enroll.WriteCertToCSP = true;
									   try
									   {
										   Enroll.acceptPKCS7(cert);
										   alert("下载证书成功！");
										   return true;
									   }
									  catch(e)
									  {
										  alert("下载证书失败"+e.message);
										  return false;
									  }	
								}
								catch(e)
								  {
									  alert("下载证书失败"+e.message);
									  return false;
								  }	
							}
						}
						
// 					}
					var keyType = "RSA";
					var templateType = 0;
					var keyLength = 2048;
// 					
// 					
// 					var keyLength = 1024;
// 					
					 
					var cspName =this.cspName;
					var containerName = this.containerName;
					
					enroll.CFCA_SetKeyAlgorithm(keyType);
					
					enroll.CFCA_SetCSPInfo(keyLength,cspName);
				    
				    // 单证签名
					if(templateType==0){
						var signCert = cert;
						enroll.CFCA_ImportSignCert(1,signCert, containerName);
						return true;
						//popupPrompts(cert_install_success);
					}
				}catch(e){
					//document.getElementById("flag").value = 0;
				
					 alert( e.message);
				}
				 
			};
			obj.initUsb=function (strSerialNum)
			{
				//debugger
				var sn=this.getUsbkeySN();
				if(sn=="error")
				{
					return false;
				}
				if(sn=="")
				{
					alert("请插入序列号为"+strSerialNum+"的Usb Key");
					return false;
				}
				if(sn!=strSerialNum)
				{ 
					alert("请插入正确序列号的Usb Key,您插入Usb Key序列号为"+sn+",应该插入的Usb Key序列号为"+strSerialNum);
					return false;
				}
				if(this.keyModel==1)
		    	{
					return true;
		    	}
				
				   if(!confirm("USB KEY 初始化后，所有证书信息将清空，usbkey密码恢复出厂值，按“确认”键继续。")) return false;
			       try
			       {
			           
			           if(this.keyModel==2||this.keyModel=="6")
				   		{
			   		 		 
			           		var retInit = this.driver.initKey();
			           		if (retInit == 1)
			           		{
			           	      alert("初始化失败！");
				               return false;
			           		}
			           			
			           		else if (retInit == 0)
			           		{
			           			return true;
			           		}
			           		else
			           		{
			           			alert("初始化失败，未知错误");
					            return false;
			           		}
				           			
				   		}
			           if(this.keyModel==3||this.keyModel=="7")
				   		{
			        	  
			        	   try {
		
			           		var retInit = this.driver.InitUsbKey("88");
			           		if(retInit==0)
			           		{
			           			return true;
			           		}
			        	   }
			        	   catch(e)
			        	   {
			        		   alert("初始化失败！");
				               return false;
			        	   }
			           		 
			           	 
			           		return true;
			           		 
				           			
				   		}
			           if(this.keyModel==4||this.keyModel=="8") //恒银
				   		{
			        	  
			           	 
			           		 var retInit = this.driver.InitUSBKey();
			           	 
			        	    if(retInit == 0)
			                {
			                   
			                   return true;
			                }else{
			                   return false;
			                }
			           		 
				           			
				   		}
			           if(this.keyModel==5||this.keyModel=="9") //恒银
				   		{
			        	   var retInit = this.driver.InitKey();
			           	 
			        	    if(retInit == 0)
			                {
			                   
			                   return true;
			                }else{
			                   return false;
			                }
				           			
				   		}
// 			           if(this.keyModel==6) //飞天
// 				   		{
// 			        	   var retInit = this.driver.InitUsbkey(strSerialNum);
			           	 
// 			        	    if(retInit == 0)
// 			                {
			                   
// 			                   return true;
// 			                }else{
// 			                   return false;
// 			                }
				           			
// 				   		}
// 			           if(this.keyModel==8 ) //飞天二代通用
// 				   		{
			        	    
// 					        	var retInit = this.driver.InitUsbkey(strSerialNum);
					        	
// 				        	    if(retInit == 0)
// 				                {
// 				                   return true;
// 				                }else{
// 				                   return false;
// 				                }
				            
// 				   		}
// 			           if( this.keyModel==26) //飞天二代通用
// 				   		{
// 			        	   // return true;
// 					        	var retInit = this.driver.InitUsbkey(strSerialNum);
					        	
// 				        	    if(retInit == 0)
// 				                {
// 				                   return true;
// 				                }else{
// 				                   return false;
// 				                }
				            
// 				   		}
// 			           if(this.keyModel==9) //飞天
// 				   		{
// 			        	   var retInit = this.driver.InitUsbkey(strSerialNum);
			           	 
// 			        	    if(retInit == 0)
// 			                {
			                   
// 			                   return true;
// 			                }else{
// 			                   return false;
// 			                }
				           			
// 				   		}
// 			           if(this.keyModel==10) //飞天生产通用
// 				   		{
// 			        	   var retInit = this.driver.InitUsbkey(strSerialNum);
			           	 
// 			        	    if(retInit == 0)
// 			                {
			                   
// 			                   return true;
// 			                }else{
// 			                   return false;
// 			                }
				           			
// 				   		}
// 			           if(this.keyModel==11) //飞天1.5标准
// 				   		{
// 			        	   var retInit = this.driver.InitUsbkey(strSerialNum);
				           	 
// 			        	    if(retInit == 0)
// 			                {
			                   
// 			                   return true;
// 			                }else{
// 			                   return false;
// 			                }
				           			
// 				   		}
// 			           if(this.keyModel==12||this.keyModel==15||this.keyModel==16|| this.keyModel==22|| this.keyModel==23) //坚石诚信一代
// 				   		{
// 			        	   return true;
// 			        	  var retInit = this.driver.InitUSBKeySN(strSerialNum);
			           	 
// 			        	    if(retInit == 0)
// 			                {
// 			                   return true;
// 			                }else{
// 			                   return false;
// 			                }		           			
// 				   		}
// 			           if(this.keyModel==13) //飞天音频
// 				   		{
			        	   
// 			        	    var retInit = this.driver.InitUsbkey(strSerialNum);
// 			        	    if(retInit == 0)
// 			                {
// 			                   return true;
// 			                }else{
// 			                   return false;
// 			                }
// 			        	   return true;
// 				   		}
// 			           if(this.keyModel==14) //飞天生产通用
// 				   		{	
// 			        	    var keyNo14;
// 							
							 
// 			        	   var retInit = this.driver.InitUsbkey(strSerialNum);
			           	 
// 			        	    if(retInit == 0)
// 			                {
// 			                   return true;
// 			                }else{
// 			                   return false;
// 			                }
				           			
// 				   		}
// 			           if(this.keyModel==25) //wd
// 				   		{
// 			        	   try
// 			        	   {
// 			        		   var retInit = this.driver.InitKey();
// 			        		   return true;
// 			        	   }
// 			        	   catch(e)
// 			        	   {
// 			        		   return false;
// 			        	   }
			        	   
				           	 
			         
				           			
// 				   		}
			       }
			       catch(e)
			       {
			            alert(e.description)
			       }
			}
	 }
	 
 }
    
	
	function getUsbkeyClassId(provider)
	{
		 if(provider=="2"||provider=="6")
		 {
			 return ["CheckUSBKey.HCheckUSBKey","CheckUSBKey.HCheckUSBKey"];
		 }
		 else if(provider=="3"||provider=="7")
		 {
			 return ["WDNongXin.WDNX","WDNongXin.WDNX"];
		 }
		 else if(provider=="4"||provider=="8")
		 {
			 return ["XJRCC.HYUSBKeyCom","XJRCC.HYUSBKeyCom"];
		 }
		 else if(provider=="5"||provider=="9")
		 {
			 return ["xjnxblxweb.LKey","xjnxblxweb.LKey"];
		 }
// 		 else if(provider=="6")
// 		 {
// 			 
// 			 
// 			 return ["Softbank.Feitian6","FTINITLIZE.FTinitlizeCtrl.1"];
// 			 
// 		 }
// 		 else if(provider=="7")
// 		 {
// 			 return [null,null];
// 		 }
// 		 else if(provider=="8")
// 		 {
// 			 return ["Softbank.Feitian8","FTINITLIZE.FTKeyCtrl.1"];
// 		 }
// 		 else if(provider=="26")
// 		 {
// 			 return ["DZSHFTKeyCtrl","DZSHFTKeyCtrl2"];
// 		 }
// 		 else if(provider=="9")
// 		 {
// 			 return ["Softbank.Feitian9","FTATLForCGXYServer.cgxy.1"]
// 		 }
// 		 else if(provider=="10")
// 		 {
// 			 return ["Softbank.Feitian10","FTINITLIZE.FTinitlizeCtrl.1"]
// 		 }
// 		 else if(provider=="11")
// 		 {
// 			 return ["Softbank.Feitian11","JSKEYSERVER.JSKeyServerCtrl.1"]
// 		 }
// 		 else if(provider=="12")
// 		 {
// 			 return ["JSKeyCtrl","JSKeyCtrl2"];
// 			 //return "FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1";
// 		 }
// 		 else if(provider=="13")
// 		 {
// 			 return ["Softbank.Feitian13","FTATLForXMI.InerPass3000.1"]
			 
// 		 }
// 		 else if(provider=="14")
// 		 {
// 			 return ["Softbank.Feitian14","FTINITLIZE.FTKeyCtrl.1"]
// 			 //return "Softbank.Feitian14";
// 		 }
// 		 else if(provider=="15")
// 		 {
// 			 //return "JSKeyCtrl";
// 			 return ["JSKeyCtrl","JSKeyCtrl2"];
// 			 //return "FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1";
// 		 }
// 		 else if(provider=="16" || provider=="22" ||provider=="23")
// 		 {
// 			 return ["JSKeyCtrl","JSKeyCtrl2"];
// 			 //return "JSKeyCtrl";
// 			 //return "FTKEYCTRLALL.FTKeyCtrlALLCtrlJANSHSTD.1";
// 		 }
// 		 else if(provider=="25")
// 		 {
// 			 return ["Softbank.WDNX","WDNongXin.WDNX.1"]
// 			 //return "Softbank.Feitian14";
// 		 }
	}
	function IsVista()
	{
	//	return false;
		var info = navigator.appVersion;
		if ( info.indexOf("NT 6.")>0 ||info.indexOf("NT 10.")>0) 
			return true; 
		else
			return false;
	}	 
</script>


 

 
	
 
<link href="/perbank/jsp/newUI/styles/login_css.jsp?v=1" rel="stylesheet" type="text/css">
<script type="text/javascript">

 
 
//软键盘
 
$(function(){
	 //设置广告图片
	 var images = '';
	 var bankFlag= '';
	 var _sign = '1';
	 var img1 = "";
	 var img2 = "";
	 var img3 = "";
// 	 if(_sign == '1' || _sign == 1){
// 		 img1 = '<img src="/perbank/resource/newUI/images/advertisement/example-slide-11.png" id="slidesImg_0" onclick="showAdvertisementDetail(0)" style="cursor:pointer;"/>';
// 		 img2 = '<img src="/perbank/resource/newUI/images/advertisement/example-slide-12.png" id="slidesImg_1" onclick="showAdvertisementDetail(3)" style="cursor:pointer;"/>';
// 		 img3 = '<img src="/perbank/resource/newUI/images/advertisement/example-slide-13.png" id="slidesImg_2"/>';
// 	 }
// 	 else{
// 	 }
		 img1 = '<img src="/perbank/resource/newUI/images/advertisement/example-slide-01.jpg" id="slidesImg_0" onclick="showAdvertisementDetail(3)" style="cursor:pointer;"/>';
		 img2 = '<img src="/perbank/resource/newUI/images/advertisement/example-slide-01.png" id="slidesImg_1"/>';
		 img3 = '<img src="/perbank/resource/newUI/images/advertisement/example-slide-02.png" id="slidesImg_2"/>';
	 

		$('.slides_container').append(img1);
		$('.slides_container').append(img2);
		$('.slides_container').append(img3);
		
	 if(images != ''){
	    var featureServiceImgs = images.split(",");
	    for(var i = 0;i < featureServiceImgs.length ; i++){
	    	var img = "<img src='"+'/perbank/ShowAdvertisementImage.servlet?objectId=' + featureServiceImgs[i]+" '/>";
			$('.slides_container').append(img);
	    }
	 }
	 
	 //广告图片轮播
	 $('#slides').slides({
		  preload: false,
	      effect: 'fade',
	      slideSpeed: 2000,
	      fadeSpeed: 200,
	      play: 3000,
	      pause: 100,
	      hoverPause: true
	});
    
	//对轮播图片进一步处理
	 if(bankFlag=='tjjc'){
		 $(".slides_container img").css("margin-left","-320px");
	}else{
		$(".slides_container img").css("margin-left","-960px");
	}
 	$(".slides_container img").css("left","50%");
 	
 	//计算登录框的位置
 	var _allWidth = $(document).width();
 	var _width ;
 	if(bankFlag=='tjjc'){
 		_width= (_allWidth - 1001) / 2 + 680;
 	}else{
 		_width = (_allWidth - 1001) / 2 + 680;
 	}
 	
 	$(".login_box_table").css("left",_width + "px");
	 
    //公告上下滚动
    var $notice = $(".noticeContent");
	var scrollTimer;
	$notice.hover(function() {
		clearInterval(scrollTimer);
	}, function() {
		scrollTimer = setInterval(function() {
			scrollNotice($notice);
		}, 2000);
	}).trigger("mouseleave");
});


if(self!=top)
	{
	  alert('请注意，您可能正在访问钓鱼网站，请通过https://www.xjrccb.com.cn 访问新疆农信网上银行。');
	   top.location=self.location;
	}	
 

function scrollNotice(obj) {
	var $self = obj.find("ul");
	var lineHeight = $self.find("li:first").height();
	$self.animate({
		"marginTop": -lineHeight + "px"
	}, 600, function() {
	$self.css({
		marginTop: 0
	}).find("li:first").appendTo($self);
})}

var useSoftBoard = false;
var pwd;

window.onload = function(){	 
	
	var UKeyLogonName = $("#logon_info").val();
   	
   	if(UKeyLogonName==''||UKeyLogonName=='underfined'){
   		var logonName = getCookie("saveLogonName");
   		if(logonName!=""&&logonName!="underfined"){
			$('#logon_info').val(logonName);
		 }
   	}
	
	
 	  pwd= new SoftKey("#passwd_div",
 			 {
		 passwordType:0 ,//0 登录密码 1 交易密码
		 showStreth: false, // 是否判断密码强度
		 showStrethEl:null,  //显示密码强度的element
		 tabIndex:2,
		 pgeOnkeydown:null,
		 pgeClass:"input_password"
});
	 	if(isNeedCheckCode=="1")
	 	{
	 		$("#liCheckCode").show();
	 	}
	 	else
	 	{
	 		$("#liCheckCode").hide();
	 	}
	 	if(IS_IE && !IS_INSTALL_CONTROL)
	 	{
	 		$("#liChkUseSafeControl").hide();
	 	}
	 	else
	 	{
	 		$("#liChkUseSafeControl").hide();
	 	}
	   	threadForUserInfo();
	 
		$("#checkCode").attr("value", checkCode);
		
		if(logon_Info==''||logon_Info=='underfined'){
			$("#logon_info").attr("value", logon_Info);
		}
	   	
	   	$("#logon_pwd_show").attr("value", logon_pwd);
		 
};
	function gotoCheckCode()
	{
		$("#checkCode").focus();
	}
	var logon_Info = '登录名/证件号/卡折号/手机号码';
	var checkCode = '验证码';
	var logon_pwd = '登录密码';
	var logonType='1';
	var isNeedCheckCode="0";
	function changeImage(){
		$("#checkCode").val('');
		document.getElementById("checkCode").className='text-colora';
		$("#checkCode").focus();
	  document.getElementById("verifyImg").src = '/perbank/VerifyImage.servlet?update=' + Math.random()+"&bankFlag="+"";;
	}
	
	function changeLanguage(language){
		document.getElementById("PreLogon_request_locale").value = language;
		document.preLogonForm.submit();
	}
	
	
	
	function signIn(){
		//获取屏幕分辨率
		var allWidth = getAllWidth();
		$("#allWidth").val(allWidth);
		
		if(isEmpty(logonType)){
			alert('alert.logonType.notnull');
			return false;
		}
		
		var logonInfo_temp = $("#logon_info").val();
		if(isEmpty(logonInfo_temp)){
			alert('请您正确输入登录信息');
			return false;
		}
		if(logonInfo_temp.indexOf("登录名/证件号/卡折号")>-1){
			alert('请您正确输入登录信息');
			return false;
		}
		
		 var password;
		 var macAddress ="";
		 
		 
		 if(!pwd.checkValid()){
			alert('密码不符合要求');
			return false;
		 }
		 password=pwd.getValue();
		 macAddress= pwd.getMacAddress();
		 
		var checkCode = $("#checkCode").val();
	
			if(isNeedCheckCode=="1" && (isEmpty(checkCode) || checkCode.length!=4)){
				alert('请输入四位验证码');
				$("#checkCode").focus();
				return false;
			}else{
				checkVertifyCode(checkCode);
			}
	
 /*
			$("#user_logonType").attr("value", logonType);
			$("#user_logonInfo").attr("value", logonInfo_temp);
			$("#user_password").attr("value", password);
			$("#user_macAddress").attr("value", macAddress);
			$("#logonForm_checkCode").attr("value", checkCode);
			$("#passwordType").val(pwd.keyboardType);
			processSubmit();
	 */
	}
	
	function processSubmit(){
		$("#logonInfo").attr("value", "");
		pwd.clear();
		$("#checkCode").attr("value", checkCode);
		
		//判断用户名是否保存
		var flag = $(':input[name=saveLogonName][checked]').val();
		if(flag=='1'){
			setCookie('saveLogonName',$('#logon_info').val());			
		}else{
			setCookie('saveLogonName','');		
		}
		
		document.logonForm.submit();
	}
	
	function checkVertifyCode(vertifyCode){
		var params ={"user.logonInfo":$("#logon_info").val(),"user.logonType":"1","user.password":pwd.getValue(),
				"user.tradePassword":pwd.getTradePassword(),"passwordType":pwd.keyboardType,
				"checkCode":vertifyCode,"user.macAddress":pwd.getMacAddress(),"allWidth":getAllWidth(),"request_locale":"zh_CN"};
	 
		$.ajax({
			// 后台处理程序
			url : '/perbank/ajax/ajaxLogonAction.action',
			// 数据发送方式
			type : "post",
			// 接受数据格式
			dataType : "json",
			// 要传递的数据
			data : params,
			//不缓存，每次重新请求后台
			cache: false,
			// 回传函数
			success : checkVertifyCodeSuccess
		});
	}
    	
   	function checkVertifyCodeSuccess(responseData){
		if(responseData.errorCode != null || responseData.errorMessage != null){
			alert(responseData.errorMessage);
			$("#liCheckCode").show();
			changeImage();		//验证码错误，刷新验证码
			return false;
		}
		if(isEmpty(logonType)){
			alert('alert.logonType.notnull');
			return false;
		}
		
		if("1"==responseData.firstLogon){
			$(':input[name=saveLogonName][checked]').val("0");
		}
		
		var logonInfo_temp = $("#logon_info").val();
		if(isEmpty(logonInfo_temp)){
			alert('请您正确输入登录信息');
			return false;
		}
		 var password;
		 var macAddress ="";
		 password=pwd.getValue();
		 macAddress= pwd.getMacAddress();
		 if(!pwd.checkValid())
		 {
			 
				alert('登录密码长度必须在6-20位之间');
				return false;
			
		 }
		 
		 
		var checkCode = $("#checkCode").val();
		$("#user_logonType").attr("value", logonType);
		$("#user_logonInfo").attr("value", logonInfo_temp);
		$("#user_password").attr("value", password);
		$("#user_tradePassword").attr("value", pwd.getTradePassword());
		$("#user_macAddress").attr("value", macAddress);
		$("#logonForm_checkCode").attr("value", checkCode);
		$("#passwordType").val(pwd.keyboardType);
		processSubmit();
	}
   	
	var flag = false;
	function declaration(){
  	var bankFlag='xjrccb';
  	if(bankFlag=='hami'){
  		try{
  		     var publicDetailDialog = parent.art.dialog.open('/perbank/declarationRsqAction', 
  		     	{id:'publicDetailDiv',
  		   			title:'package.declaration.haminotice',
  		     		width: 900,
  		     		height: 480,
  		     		fixed: true, 
  		     		drag: false,  //禁止拖拽
  				    resize: false, //禁止放大缩小窗口 
  		     		lock: true, 
  		     		opacity: 0.1, 
  		     		close: function () {
  		     			parent.art.dialog.data("publicDetailDialog", null);
  		     			if(flag){
  		     				setTimeout(doIt,100);	
  		     			}
  		     		}});
  		     	parent.art.dialog.data("publicDetailDialog", publicDetailDialog);
  			 }catch(e){}
  	}else{
  		document.declarationForm.submit();
  	}
	}
	function doIt(){
		flag=false;
		document.declarationForm.submit();
	}
	
	function checkCodeKeyDown(n){
		if(n==3){
			if (!isIntChar($("#checkCode").val())){
				$("#checkCode").val('');
		    }
		}
		else if(n==2){
			
				//$("#logon_pwd").val('');
		    
		} 
	}
	
	function resetPassword(){
		document.resetPasswordForm.submit();
	}
	function downloadControl()
	{
		var dlcDialog = parent.art.dialog.open('/perbank/resource/downloadControl.html',
    			{id:'dlcDialog',
    		     title:'下载安全控件',
    		     width: 700,
    		     height: 450,
    		     fixed: true,
    		     lock: true, 
    		     drag: false,
    		     resize:false,
    		     opacity: 0.1, 
    		     close: function () {
    		    	 parent.art.dialog.data("dlcDialog", null);
    		     }});
    	parent.art.dialog.data("dlcDialog", dlcDialog);
	}
	function showDetail(objectId){
		var params = '?pubnotice.objectId=' + objectId;
		 try{
	        	var accDetailDialog = parent.art.dialog.open('/perbank/showPageNociteNoSessionAction'+params,
	        			{id:'accDetailDiv',
	        		     title:'公告详情',
	        		     width: 700,
	        		     height: 450,
	        		     fixed: true,
	        		     lock: true, 
	        		     drag: true,
	        		     resize:false,
	        		     opacity: 0.1, 
	        		     close: function () {
	        		    	 parent.art.dialog.data("accDetailDialog", null);
	        		     }});
	        	parent.art.dialog.data("accDetailDialog", accDetailDialog);
		 }catch(e){}
	}
		
		 function checkCodeFocus(type){
			 if(type==1){
				 if ($("#logon_info").val()==logon_Info ){
						$("#logon_info").val('');
				    }
				}else if(type==2){
						if($("#logon_pwd_show").val()==''){
						}else{
						$("#logon_pwd_show").attr("value","");
						$("#logon_pwd_show").hide();
						$("#logon_pwd").show();
						$("#logon_pwd").focus();
						}
				}else if(type==3){
				var name=$("#checkCode").val() ;
				 if(name==checkCode){
				  $("#checkCode").val("");
				  document.getElementById("checkCode").className='text-colora';
				 
				 }
				}
			}

			function  checkCodeBlur(type){
				if(type==1){
					if ($("#logon_info").val()=='' ){
						$("#logon_info").val(logon_Info);
				    }
				}else if(type==2){
						if($("#logon_pwd").val()==""){
						$("#logon_pwd_show").show();
						$("#logon_pwd_show").val(logon_pwd);
						$("#logon_pwd").val("");
						$("#logon_pwd").hide();
						}else{
						}
				}else if(type==3){
				 if($("#checkCode").val()==''){
					 $("#checkCode").val(checkCode);
					 document.getElementById("checkCode").className='text-color';
				 }else{
					 
				 }
				}
			}
			
			function chainedAddress(url) {
				$("#url").attr("value", url);
			}
	
 
		var keyNo = '';
		var t;
		function threadForUserInfo(){
			t = setTimeout(threadGetUserInfo,1000);
		}
		function getUsbKey(){
			
			var listNum = 0;
			var keyModel="1";
			
			for(var i=0;i<keyProviders.length;i++)
			 {
				 if(keyProviders[i] && keyProviders[i].driver){
					 obj=keyProviders[i];
					 keyModel=obj.keyModel;
					 listNum = obj.listNum();
					 if(1==listNum){
						 break;
					 }
				}
			}
			
			var resArr =new Array();
			resArr[0]=listNum;
			resArr[1]=keyModel;
			return resArr;
		}
		var isNoticed=false;
		//查询key,当查找5次找不到key时,就不再去找了
		var times=5;
	    function threadGetUserInfo(){
	       	var resArr =getUsbKey();
	       	if(--times==0){
	       		return;
	       	}
			var listNum = resArr[0];
			var keyModel = resArr[1];
			if(listNum==999){
				threadForUserInfo();
				isNoticed = true;
				return;
			}
				
			if( listNum>1 ){
					threadForUserInfo();
					isNoticed = true;
					return;
			}else if( listNum==0 ){
					keyNo = '';
					threadForUserInfo();
					isNoticed = true;
					return;
			}else if( listNum==1 ){
					var tempStr="" ;
					
					tempStr =keyProviders[keyModel].getUsbkeySN();
					
					getUserInfo( tempStr ) ; 
					return;
			}
		}

		function getUserInfo( tmpKeyNo ){
			 
			if( keyNo=='' ){
				keyNo = tmpKeyNo;
				if(!isEmpty(keyNo)){
					queryUser(keyNo);
				}       				
			}else if( keyNo!=tmpKeyNo ){
				keyNo = tmpKeyNo;
				if(!isEmpty(keyNo)){
					queryUser(keyNo);
				}       				
			}
		}
	       	
	   	function queryUser(keyNo){
			var params ={"keyNo":keyNo};
			$.ajax({
				// 后台处理程序
				url : '/perbank/ajax/GetCertUserAction.action',
				// 数据发送方式
				type : "post",
				// 接受数据格式
				dataType : "json",
				// 要传递的数据
				data : params,
				//不缓存，每次重新请求后台
				cache: false,
				// 回传函数
				success : queryUserSuccess
			});
		}
	    	
	   	function queryUserSuccess(responseData){
			if(responseData.errorCode!=null||responseData.errorMessage!=null){
				alert(responseData.errorMessage);
				threadForUserInfo();
				return;
			}
			if(!isEmpty(responseData.alias)){
				if(logonType=="1"){
				}else{
					tag('1');
				}
					$('#logon_info').val(responseData.alias);
					clearTimeout(t);	
			}
			else{
				threadForUserInfo();
			}
			
		}
	    
 
</script>


	<div id="showNoticeInfo" class="noticeInfo">
		<div class="noticeInfoTitle">
			<span class="title"></span> <span class="time"></span>
		</div>
		<div class="noticeInfoContent">
			<p id="content"></p>
		</div>
		<div class="noticeInfoBottom">
			<span class="closeI"><input name="noticeView" id="noticeView" type="checkbox" checked="checked">下次不再显示</span> <input type="hidden" id="noticeId"> <span class="closeB" onclick="closeNoticeInfo()">关闭</span>
		</div>
	</div>
	<div class="logo_div">
		<div class="bankLogo"></div>
		<div class="logoInfo">
			<div class="logo_home">
				<a href="https://www.xjrccb.com.cn" class="index" target="_blank" tabindex="100">新疆农村信用社首页</a> <span>|</span>
				<a href="javascript:void(0)" onclick="addFavorite()" tabindex="99">添加至收藏夹</a>
		 
				
			</div>
			<div class="logo_info">
			
				<a href="https://www.xjrccb.com.cn" target="_blank" tabindex="98">&nbsp;机构网点</a>
				<span>|</span> 客户热线：<strong class="phoneColor">0991-96596</strong>
			</div>
		</div>
	</div>
	<div class="noticeContent">
		<span class="notice_bg"></span> <span class="notice_title">本行公告：</span>
		<div id="newslistwraper">
			<ul id="noticeBody" style="margin-top: 0px; "></ul>
		</div>
	</div>
	<div style="width: 100%; text-align: center;" id="ad_slides_main">
		<div id="slides">
			<div class="slides_container" style="overflow: hidden; position: relative; display: block; "><div class="slides_control" style="position: relative; width: 0px; height: 400px; left: 0px; "><img src="/perbank/resource/newUI/images/advertisement/example-slide-01.jpg" id="slidesImg_0" onclick="showAdvertisementDetail(3)" style="cursor: pointer; position: absolute; top: 0px; left: 50%; z-index: 0; margin-left: -960px; display: none; "><img src="/perbank/resource/newUI/images/advertisement/example-slide-01.png" id="slidesImg_1" style="position: absolute; top: 0px; left: 50%; z-index: 0; margin-left: -960px; display: block; "><img src="/perbank/resource/newUI/images/advertisement/example-slide-02.png" id="slidesImg_2" style="position: absolute; top: 0px; left: 50%; z-index: 0; margin-left: -960px; display: none; "></div></div>
		<ul class="pagination"><li class=""><a href="#0">	</a></li><li class="current"><a href="#1">	</a></li><li class=""><a href="#2">	</a></li></ul></div>
		<div class="login_box_table" style="top: 5px; left: 714.5px; ">
			<div class="login_tab">
				<ul>
					<li id="first" class="actived" onclick="loginInfo()">用户登录</li>
					<li onclick="declaration()">自助注册</li>






					<li id="last" onclick="clientBank();">手机银行 </li>
 				</ul>
			</div>
			<div class="login_content" id="login_content" style="height: 350px;">
				<ul>
					<li>
						<div id="userDiv" class="inputDiv userDiv">
							<input type="text" name="logon_info" id="logon_info" onfocus="checkCodeFocus(1);" onblur="checkCodeBlur(1);" tabindex="1" onkeyup="checkCodeKeyDown(1);">
						</div>
					</li>
					<li> 
							<div class="inputDiv passwd_div" id="passwd_div"><input tabindex="2" class="input_password" type="password" name="input_5491752" id="input_5491752" style="" maxlength="20"><div id="div_5491752" title="软键盘指软件模拟键盘，您可以通过鼠标点击输入字符，防止木马记录键盘输入的密码。" style="background:url(/perbank/resource/images/softKey.jpg?v=1) no-repeat center;width:24px;height:100%;float:right;"></div></div>
						 
						 </li>
					<li id="liCheckCode" style="display: none; ">
						<div id="checkCode_div" class="inputDiv_temp" style="margin: 0px; overflow: hidden">
							<div class="checkInput check">
								<input type="text" name="checkCode" id="checkCode" tabindex="4" maxlength="4" lable="验证码" onfocus="checkCodeFocus(3);" onblur="checkCodeBlur(3);" onkeyup="checkCodeKeyDown(3);" onkeydown="if(13==event.keyCode || 27==event.keyCode) signIn();" value="验证码">
							</div>
							<div class="wes">
								<span class="yzm" style="cursor: pointer" onclick="javascript:changeImage();">
									<img id="verifyImg" src="/perbank/VerifyImage.servlet?bankFlag=">
									
								</span>
							</div>
						</div>
					</li>
					<li style="height:20px;">
					<span style="float: left;"><input type="checkbox" id="saveLogonName" name="saveLogonName" checked="checked" value="1"> 保存登录名</span>
					<span id="liChkUseSafeControl" style="display: none; ">
					
					<input type="checkbox" name="chkUseSafeControl" id="chkUseSafeControl" tabindex="3" onclick="downloadControl();" lable="使用安全控件登录">&nbsp;&nbsp;使用安全控件登录
					</span>
					</li>
					<li id="logon_li"><div class="loginButtonDiv" id="logon_div" onclick="javascript:signIn()"></div></li>
					<li><a onclick="resetPassword();" tabindex="4">忘记密码?</a></li>
					<li style="font-size:9px;">
					<div>请持UsbKey安全工具用户，安装<a style="font-size:12px;display:inline;width:100px;color:red;" href="javascript:void(0);" onclick="javascript:opens('https://www.xjrccb.com.cn/corbank/ocx/XJNXEBankAssist_Setup.exe')">UsbKey管理工具</a>，建议使用<a style="font-size:12px;display:inline;width:50px;color:red;" href="javascript:void(0);" onclick="javascript:opens('https://www.xjrccb.com.cn/corbank/ocx/XJNXEBankAssist_Setup.exe')">网银助手</a><div></div></div></li>
					<br>
					<li>
						<a href="./download/gerenjiaoyiguize.doc" target="_blank" alt="可下载查看" style="font-size:13px;width:100%;">《个人网银交易规则及风险提示书》</a>
					</li>
				</ul>
			</div>
			
			<div class="login_content" id="client_content" style="display: none">










				<hr style="width: 98%; margin-left: auto; margin-right: auto; height: 1px; border: 0px; border-bottom: 1px dashed #666666">
				<span class="android">
					<span class="text fR">
						下载<a style="font-size:14px;display:inline;" href="https://www.xjrccb.com.cn/download/android/mBank.apk" target="_blank">手机银行</a>
					</span>
					<img src="/perbank/ShowMoblieQRCode.servlet?bankFlag=xjrccb">
				</span>
			</div>
		</div>
	</div>
	<div class="warnNotice_div">
		<div class="modelDiv">
			<ul>
				<li style="width: 330px" onclick="javascript:opens('https://www.xjrccb.com.cn/corbank/ocx/XJNXEBankAssist_Setup.exe')">
					<a href="javascript:void(0);" class="modelImg wyzs" tabindex="5"></a> <span class="modelTitle">网银助手</span> <span class="modelContent">您可以下载、安装网银助手</span>
				</li>
				<li style="width: 330px" onclick="javascript:opens('/perbank/helpCenter')">
					<a href="javascript:void(0);" class="modelImg bzzx" tabindex="6"></a> <span class="modelTitle">帮助中心</span> <span class="modelContent">网银操作指南及常见问题汇总</span>
				</li>
				<li style="width: 330px" onclick="opens('/perbank/safetyTips')">
					<a href="javascript:void(0);" class="modelImg aqts" tabindex="7"></a> <span class="modelTitle">安全提示</span> <span class="modelContent">正确使用网上银行能够防范风险</span>
				</li>
			</ul>
		</div>
	</div>
	<div class="bottom_div">
		<div class="copyRight">
			<span>新疆农村信用社 © 版权所有</span>
		</div>
	</div>
	<form action="/perbank/Logon" method="post" name="logonForm" id="logonForm">
		<input type="hidden" name="user.logonInfo" value="" id="user_logonInfo">
		<input type="hidden" name="user.logonType" value="" id="user_logonType">
		<input type="hidden" name="user.password" value="" id="user_password">
		<input type="hidden" name="user.tradePassword" value="" id="user_tradePassword">
		<input type="hidden" name="passwordType" value="" id="passwordType">
		<input type="hidden" name="checkCode" value="" id="logonForm_checkCode">
		<input type="hidden" name="user.macAddress" value="" id="user_macAddress">
		<input type="hidden" name="allWidth" value="" id="allWidth">
		<input type="hidden" name="request_locale" value="zh_CN" id="request_locale">
	</form>
	<form action="/perbank/PreLogon" method="post" name="preLogonForm" id="preLogonForm">
		<input type="hidden" name="request_locale" value="" id="PreLogon_request_locale">
	</form>
	<form action="/perbank/RegistDeclaration?bankFlag=xjrccb" method="post" name="declarationForm" id="declarationForm"></form>
	<form action="/perbank/ResetPasswordReq?bankFlag=xjrccb" method="post" name="resetPasswordForm" id="resetPasswordForm">
	</form>
	<form action="/perbank/chainedAddressReq" method="post" name="chainedAddressForm" id="chainedAddressForm">
		<input type="hidden" name="url" value="" id="url">
	</form>
	<form id="toLogonForm" name="toLogonForm" action="/perbank/toLogonAction.action" method="post">
		  <input type="hidden" id="noControlVersion" name="noControlVersion">
	</form>



	<form id="IndexAction" name="IndexAction" action="/perbank/IndexAction.action" method="post">
		  <input type="hidden" id="bankFlag" name="bankFlag">
	</form>




<script type="text/javascript">
$(function(){
	queryShowNotice();
})

function opens(url){
	url = url.replace(/[\r\n]/g,"");
	window.open(url);
}

function clientBank(){
	$(".login_tab li").removeClass();
	$("#last").attr("class","actived");
	$("#login_content").hide();
	$("#client_content").show();
	
	$("#last .clientSpan").attr("class","clientSpanclicked");
	$("#last .font").css("color","#46C6F1");
}

function loginInfo(){
	$(".login_tab li").removeClass();
	$("#first").attr("class","actived");
	$("#client_content").hide();
	$("#login_content").show();
	
	$("#last .clientSpanclicked").attr("class","clientSpan");
	$("#last .font").css("color","#FFFFFF");
}

//查询公告信息
function queryShowNotice(){
	var params;
	var	url = '/perbank/ajax/ajaxCstShowNoticeNoSession';
	ajaxSend( url, params, queryListShowNotice );
}

function queryListShowNotice(responseData){
	var count =0;
	$.each(responseData.bankNoticeList, function(i,notice){
		if(i == 0){
			showNoticeInfo(notice);
		}
		var objectId = nvl(notice.objectId, '');
		$("#noticeBody").append(
				"<li>"+
					'<a href="#" onclick="javascript:showDetail(\''+objectId+'\');">' + 
						(parseInt(count)+parseInt(1))+'、'+ notice.title + '  ---' + notice.dateTime +
					"</a>"+
				"</li>"
		);
		count+=1;
	});
}

function showNoticeInfo(notice){
	var _id = "notice_" + notice.objectId;
	if(checkNotice(_id)){
		$("#showNoticeInfo p[id='content']").html(notice.content);
		$("#showNoticeInfo .noticeInfoTitle .title").html(notice.title);
		$("#showNoticeInfo .noticeInfoTitle .time").html("发布时间：" +notice.dateTime);
		$("#showNoticeInfo #noticeId").val(notice.objectId);
		//计算公告的显示位置
		var _width = ($(document.body).width() - 1001) / 2;
		$(".noticeInfo").css("left",_width + 50);
		$(".noticeInfo").show("slow");
	};
}

function checkNotice(id){
	var _name = GetCookie(id);
	if(isEmpty(_name)){
		return true;
	}
	return false;
}

function closeNoticeInfo(){
	$("#showNoticeInfo").hide("slow");
	if($("#noticeView").attr("checked")){    //点击不再显示，将用户信息保存至cookie中
		var _id = "notice_" + $("#showNoticeInfo #noticeId").val();
		var expdate = new Date();
	    FixCookieDate (expdate);
	    expdate.setTime (expdate.getTime() + (24 * 30 * 3 * 60 * 60 * 1000));
		SetCookie(_id,"isExist",expdate);
	}
}

function addFavorite(){
	var url = window.location.href;
	var title = '新疆农村信用社';
	
	try {
		window.external.addFavorite(url, title);
	}catch (e) {
		try {
			window.sidebar.addPanel(title, url, "");
		}catch (e) {
			alert("抱歉，您所使用的浏览器无法完成此操作。\n\n加入收藏失败，请进入新网站后使用Ctrl+D进行添加");
		}
	}
}

function showAdvertisementDetail(i){
	
	
}
	//通过写注册表 修改IE设置 SSL3.0 TLS1.0 TLS1.1 TLS1.2 为勾选 SSL2.0为不勾选
	try{  
	   var shell = new ActiveXObject("WScript.Shell");  
	   var  key  = shell.RegRead("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SecureProtocols"); 
	   shell.RegWrite("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SecureProtocols", "2720","REG_DWORD");  
	     
	   }catch(e)  
	   {  
	   	
	   }  
</script>

<div style="display: none; position: fixed; left: 0px; top: 0px; width: 100%; height: 100%; cursor: move; opacity: 0; background-color: rgb(255, 255, 255); background-position: initial initial; background-repeat: initial initial; "></div><iframe id="fra_softKey" style="position:absolute; left:0px; top:0px; width:400px; z-index:3000;display:none;height:150px;"></iframe><div align="center" id="softkeyboard" name="softkeyboard" style="position:absolute; left:0px; top:0px; width:400px; z-index:65535;display:none"> <table id="CalcTable" width="" border="0" align="center" style="border:1px solid #B5ADF1" cellpadding="0" cellspacing="0" bgcolor=""><form id="Calc" name="Calc" action="" method="post" autocomplete="off"></form><tbody><tr><td style="cursor: default;height:30px;padding-top: 3px;background-color:#f6f6f6;" align="center" valign="middle" bgcolor="">&nbsp;<font style="font-weight:bold; font-size:15px; color:black"> 新疆农信&nbsp;&nbsp;密码输入器</font>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   </td></tr><tr align="center"> <td align="center" bgcolor="#FFFFFF"><div style="background-color:#ffffff;"><table align="center" width="%" border="0" cellspacing="1" cellpadding="0">
<tbody><tr align="left" valign="middle"> 
 <td> <input type="button" value="~" title="~" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="!" title="!" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "> </td>
<td> <input type="button" value="@" title="@" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" value="#" title="#" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="$" title="$" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td><input type="button" value="%" title="%" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
 <td><input type="button" value="^" title="^" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="&amp;" title="&amp;" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td><input type="button" value="*" title="*" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="(" title="(" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td><input type="button" value=")" title=")" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "> </td>
<td><input type="button" value="_" title="_" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="+" title="+" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td><input type="button" value="|" title="|" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td colspan="1" rowspan="1"><input name="useKey" style="width:100px;height:28px; font-size:14px;BORDER: #e6e6e6 1px solid;CURSOR: pointer; COLOR: black;  FONT-SIZE: 14px;" type="button" value="切换到键盘" bgtype="1"> 
</td>
</tr>
<tr align="left" valign="middle"> 
<td><input width="38" height="38" type="button" value="`" title="`" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td><input type="button" class="btn_num" ="2"="" name="button_number1" value="1" title="1" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" class="btn_num" name="button_number2" value="2" title="2" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "> </td>
<td> <input type="button" class="btn_num" name="button_number3" value="3" title="3" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" class="btn_num" name="button_number4" value="4" title="4" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" class="btn_num" name="button_number5" value="5" title="5" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "> </td>
<td> <input type="button" class="btn_num" name="button_number6" value="6" title="6" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" class="btn_num" name="button_number7" value="7" title="7" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" class="btn_num" name="button_number8" value="8" title="8" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" class="btn_num" name="button_number9" value="9" title="9" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
 <td> <input class="btn_num" name="button_number0" type="button" value="0" title="0" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="-" title="-" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="=" title="=" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="\" title="\" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value=" 退格 " name="btnBackSpace" style="width:100px;height:30px;BORDER-RIGHT:1px none;FONT-SIZE: 14px"> </td>
</tr>
<tr align="left" valign="middle"> 
<td> <input type="button" name="button_q" value="q" title="q" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_w" value="w" title="w" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_e" value="e" title="e" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_r" value="r" title="r" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_t" value="t" title="t" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_y" value="y" title="y" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_u" value="u" title="u" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_i" value="i" title="i" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_o" value="o" title="o" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input name="button_p" type="button" value="p" title="p" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input name="button9" type="button" value="{" title="{" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="}" title="}" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
 <td> <input type="button" value="[" title="[" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="]" title="]" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td><input name="btn_changeCase" type="button" value="切换大/小写" style="width:100px;height:30px;BORDER-RIGHT:1px none;font-size:15px"> </td>
</tr>
<tr align="left" valign="middle"> 
<td>  <input type="button" name="button_a" value="a" title="a" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td> 
<td> <input type="button" name="button_s" value="s" title="s" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
 <td> <input type="button" name="button_d" value="d" title="d" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
 <td> <input type="button" name="button_f" value="f" title="f" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
 <td> <input type="button" name="button_g" value="g" title="g" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_h" value="h" title="h" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" name="button_j" value="j" title="j" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input name="button_k" type="button" value="k" title="k" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input name="button_l" type="button" value="l" title="l" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input name="button5" type="button" value=":" title=":" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input name="button7" type="button" value="&quot;" title="&quot;" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
 <td> <input type="button" value=";" title=";" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" value="'" title="'" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td rowspan="2" colspan="2"> <input name="btn_keyBoardOK" type="button" bgtype="1" value="   确定   " style="BORDER:3px solid blue;width:130px;height:60px;FONT-SIZE: 23px;"> </td>
</tr>
<tr align="left" valign="middle"> 
<td> <input name="button_z" type="button" value="z" title="z" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" name="button_x" value="x" title="x" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input name="button_c" type="button" value="c" title="c" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" name="button_v" value="v" title="v" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" name="button_b" value="b" title="b" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" name="button_n" value="n" title="n" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" name="button_m" value="m" title="m" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td>  <input type="button" value="&lt;" title="&lt;" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="&gt;" title="&gt;" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="?" title="?" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
<td> <input type="button" value="," title="," style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
 <td> <input type="button" value="." title="." style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "> </td>
 <td> <input type="button" value="/" title="/" style="background-color: rgb(247, 249, 251); width: 28px; height: 28px; line-height: 18px; color: rgb(102, 102, 102); padding: 0px; "></td>
</tr>
</tbody></table></div></td> </tr></tbody></table></div><div style="display: none; position: absolute; " class=""><div class="aui_outer"><table class="aui_border"><tbody><tr><td class="aui_nw"></td><td class="aui_n"></td><td class="aui_ne"></td></tr><tr><td class="aui_w"></td><td class="aui_c"><div class="aui_inner"><table class="aui_dialog"><tbody><tr><td colspan="2" class="aui_header"><div class="aui_titleBar"><div class="aui_title" style="cursor: move; "></div><a class="aui_close" href="javascript:/*artDialog*/;" style="">×</a></div></td></tr><tr><td class="aui_icon" style="display: none; "><div class="aui_iconBg" style="background-image: none; background-position: initial initial; background-repeat: initial initial; "></div></td><td class="aui_main" style="width: auto; height: auto; "><div class="aui_content" style="padding: 20px 25px; "></div></td></tr><tr><td colspan="2" class="aui_footer"><div class="aui_buttons" style="display: none; "></div></td></tr></tbody></table></div></td><td class="aui_e"></td></tr><tr><td class="aui_sw"></td><td class="aui_s"></td><td class="aui_se" style="cursor: se-resize; "></td></tr></tbody></table></div></div></body></html>